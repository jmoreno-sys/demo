@using Microsoft.AspNetCore.Identity
@model ReporteViewModel
@{
    ViewData["Title"] = "Consultas";
    var detalleConsultas = User.IsInRole(Dominio.Tipos.Roles.AdministradorEmpresa) || User.IsInRole(Dominio.Tipos.Roles.Administrador) ? 1 : 0;
    var idEmpresa = ViewBag.IdEmpresa;
}

<style>
    .popover {
        max-width: 700px;
    }
</style>

<section class="container-fluid px-xl-5 px-lg-5 px-md-1 px-sm-0" id="content">
    <div class="row d-print-none animate__animated animate__fadeInUp">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body p-3 pb-2">
                    <form class="row row-cols-lg-auto g-3 align-items-center" id="formBalance" method="POST">
                        @Html.AntiForgeryToken()
                        <div class="col-12">
                            <input type="hidden" asp-for="IdHistorial" />
                            <div class="form-outline">
                                <input type="search" asp-for="Identificacion" class="form-control input-integer d-print-inline" placeholder="Ingresar RUC o Cédula" pattern=".{10,}" title="Mínimo 10 carácteres" maxlength="13" required />
                                <label class="form-label" asp-for="Identificacion">RUC/Cédula</label>
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary-custom btn-primary-custom d-inline-flex" id="btnBuscar"><i class="fa-solid fa-magnifying-glass my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Buscar</span></button>
                            <button type="button" class="btn btnBuscarNombreModal btn-primary-custom d-inline-flex" data-toggle="modal" data-target="#modalBuscarNombre" id="btnBuscarNombreModal"><i class="fa-solid fa-user my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Buscar por Nombres</span></button>
                            <button type="button" class="btn btnBuscarPlacaModal btn-primary-custom d-inline-flex" data-toggle="modal" data-target="#modalBuscarPlaca" id="btnBuscarPlacaModal"><i class="fa-solid fa-car my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Placa</span></button>
                            <button class="btn btn-primary-custom btn-primary-custom d-inline-flex" id="btnLimpiar"><i class="fa-solid fa-eraser my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Limpiar</span></button>
                            <button class="btn btn-primary-custom btn-primary-custom d-inline-flex" id="btnImprimir"><i class="fa-solid fa-print my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Imprimir</span></button>
                            <a class="btn btnResumen btn-primary-custom mt-1 mt-sm-0  d-inline-flex" id="btnResumen" href="#"><i class="fa-solid fa-clipboard-check my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Resumen</span></a>
                        </div>
                    </form>

                    <div class="row pt-2">
                        <div class="col">
                            <div id="divResumenConsultas"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalBuscarNombre" tabindex="-1" role="dialog" aria-labelledby="modalBuscarNombreLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <img src="~/images/modales/BuscarNombre.svg" alt="" width="23" height="23">
                    <h5 class="modal-title ml-1">Buscar por Nombres</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col">
                            <form id="formEmpresa" method="post">
                                <div class="col-lg-12 col-md-12 col-sm-12 pl-0 pr-0">
                                    <label class="col-form-label col-form-label-sm required">Apellidos y Nombres</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text"><i class="fa-solid fa-chalkboard-user"></i></span>
                                        </div>
                                        <input id="inputNombre" class="form-control form-control-sm text-uppercase input-border-radius input-string required" maxlength="200" autocomplete="off" required>
                                        <div class="input-group-append">
                                            <button type="button" id="btnBuscarNombre" class="btn btn-sm " data-tippy-content="Buscar Coincidencias" data-tippy-placement="bottom"><i class="fa-solid fa-magnifying-glass"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col">
                            <div class="alert alert-info p-2 mb-1" role="alert">
                                <h6 class="info-note"><b>Nota: </b>Es obligatorio ingresar <b>Apellidos</b> y luego <b>Nombres</b>. Al seleccionar una fila de la tabla podrá consultar la información de la persona seleccionada.</h6>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col">
                            <table id="tablaNombres" class="table table-sm table-bordered table-hover table-striped w-100">
                                <thead class="text-center">
                                    <tr>
                                        <th>Cédula</th>
                                        <th>Nombres</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                                <tfoot>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary-custom" data-dismiss="modal"><i class="fa-solid fa-x mr-2"></i>Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalBuscarPlaca" tabindex="-1" role="dialog" aria-labelledby="modalBuscarPlacaLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-dialog modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <img src="~/images/modales/buscarPlaca.svg" alt="" width="23" height="23">
                        <h5 class="modal-title ml-1">Buscar por Placa</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col">
                                <form id="formPlaca" method="post">
                                    <div class="col-lg-12 col-md-12 col-sm-12 pl-0 pr-0">
                                        <label class="col-form-label col-form-label-sm required">Placa</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text"><i class="fa-solid fa-car-side"></i></span>
                                            </div>
                                            <input id="inputPlaca" class="form-control form-control-sm text-uppercase input-border-radius input-stringinteger" maxlength="7" autocomplete="off" required>
                                            <div class="input-group-append">
                                                <button type="submit" id="btnBuscarPlaca" class="btn btn-sm " data-tippy-content="Buscar Placa" data-tippy-placement="bottom"><i class="fa-solid fa-magnifying-glass"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col">
                                <div class="alert alert-info p-2 mb-1" role="alert">
                                    <h6 class="info-note"><b>Nota: </b>Es obligatorio ingresar las placas con 4 dígitos <b>Ejemplo:</b> AAA999 es AAA0999</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="divInformacionGeneral" class="pt-2 animate__animated animate__fadeIn" style="display: none;">
        <partial name="ReporteDemo" />
    </div>
</section>

<partial name="Components/_Datatables" />
<partial name="Components/_Avisos" />
<partial name="Components/_Highcharts" />
<partial name="Components/_Loader" />
<partial name="Components/_Datepicker" />

@section Scripts{
    <script>
        let idEmpresa = parseInt("@ViewBag.IdEmpresa");
        let rucNuevo = "@ViewBag.Identificacion";
        let tipoIdentificacionTemp = "";
        let identificacionTemp = "";
        let idHistorialTemp = 0;
        let actualizarCalificacionTemp = false;
        let idCalificacionTemp;
        let idCalificacionBuroTemp;
        let nombreTemp = "";
        let tipoIdentificacionTempCalificacion;
        let estadoPlanEvaluacion = false;
        let estadoPlanBuroCredito = false;
        let listaRepresentantesEmpresas = 0;
        let tipoFuentePredios = 0;
        let modeloIndumot = false;
        let modeloBCapital = false;
        let modeloCooperativas = false;

        let tabla;
        let tablaBuro;
        let tablaNombres;
        let tablaResumenCalificacion;
        let tablaResumenCalificacionBuro;
        let fechaCedulacionIngreso = false;
        let confirmacionAceptada = false;

        $(document).ready(function () {
            ////////////////////////////////////////////////////////////////////////////
            //Inicialización
            $('#btnEvaluar').prop('disabled', true);
            $('#btnBuscarBuroCreditoNuevo').prop('disabled', true);
            $('#btnBuscarPrediosNuevo').prop('disabled', true);
            $('#btnBuscarAntecedentesNuevo').prop('disabled', true);
            $('#btnBuscarFiscaliaNuevo').prop('disabled', true);
            $('#btnBuscarImpedimentoNuevo').prop('disabled', true);
            $('#btnBuscarUafeNuevo').prop('disabled', true);
            //$('#btnBuscarSuperBancosNuevo').prop('disabled', true);
            $("#divBarraCalificacion").hide();
            $("#divResumenConsultas").hide();
            // obtenerResumenConsultas();
            if (rucNuevo && rucNuevo !== "") {
                confirmacionAceptada = true;
                setTimeout(function () {
                    $("#Identificacion").val(rucNuevo);
                    $("#btnBuscar").click();
                    hideLoader();
                }, 1000);
            } else
                hideLoader();

            ////////////////////////////////////////////////////////////////////////////
            //Eventos Consultas
            $("#formBalance").submit(function (e) {
                e.preventDefault();
                limpiar();

                if (confirmacionAceptada) {
                    procesarConsulta();
                    confirmacionAceptada = false;
                } else {
                    Swal.fire({
                        title: 'Consentimiento expreso e informado del Titular',
                        text: "Confirmo tener el consentimiento expreso e informado de principios, derechos y finalidades para la consulta del titular",
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonColor: _confirmButtonColor,
                        cancelButtonColor: _cancelButtonColor,
                        confirmButtonText: "SI",
                        cancelButtonText: "NO"
                    }).then((result) => {
                        if (result.isConfirmed) {
                            procesarConsulta();
                        } else {
                            $("#btnLimpiar").click();
                            limpiar();
                        }
                    });
                }
            });

            function procesarConsulta() {
                let identificacion = $("#Identificacion").val();
                let antiForgeryToken = $("input[name=__RequestVerificationToken]").val();
                $.post({
                    url: "@Url.Action("GuardarHistorial", "PrincipalDemo", new { Area = "Consultas"})",
                    headers: { 'RequestVerificationToken': antiForgeryToken },
                    data: { 'identificacion': identificacion },
                    beforeSend: function () {
                        actualizarCalificacionTemp = false;
                        initLoadingSwal("Registrando consulta...");
                        $('#btnBuscar').prop('disabled', true);
                        $('#btnLimpiar').prop('disabled', true);
                        $('#btnImprimir').prop('disabled', true);
                        $('#btnEvaluar').prop('disabled', true);
                        $('#btnBuscarNombreModal').prop('disabled', true);
                        $('#btnBuscarPlacaModal').prop('disabled', true);
                        $('#btnBuscarBuroCreditoNuevo').prop('disabled', true);
                        $('#btnBuscarPrediosNuevo').prop('disabled', true);
                        $('#btnBuscarAntecedentesNuevo').prop('disabled', true);
                        $('#btnBuscarFiscaliaNuevo').prop('disabled', true);
                        $('#btnBuscarImpedimentoNuevo').prop('disabled', true);
                        $('#btnBuscarUafeNuevo').prop('disabled', true);
                        //$('#btnBuscarSuperBancosNuevo').prop('disabled', true);
                        $("#divBarraCalificacion").hide();
                        $("#divBusquedaBuroCredito").css('display', 'none');
                        $("#divBusquedaPredios").css('display', 'none');
                        $("#divBusquedaAntecedentes").css('display', 'none');
                        $("#divBusquedaFiscalia").css('display', 'none');
                        $("#divBusquedaImpedimento").css('display', 'none');
                        $("#divBusquedaUafe").css('display', 'none');
                        $("#divBusquedaSuperBancos").css('display', 'none');
                    },
                    success: function (data) {
                        if (!data) {
                            Swal.fire("¡Error!", `No se pudo registrar la consulta`, "error");
                            limpiar();
                            return false;
                        }

                        if (data.idHistorial && parseInt(data.idHistorial) === 0) {
                            Swal.fire("¡Error!", `No se pudo registrar la consulta`, "error");
                            limpiar();
                            return false;
                        }

                        Swal.close();
                        // obtenerResumenConsultas();
                        tipoIdentificacionTemp = data.tipoIdentificacion;
                        idHistorialTemp = parseInt(data.idHistorial);
                        identificacionTemp = identificacion;
                        idCalificacionTemp = 0;
                        idCalificacionBuroTemp = 0;
                        $('#IdHistorial').val(data.idHistorial);

                        //Consultas
                        if (data.tipoIdentificacion === "@Dominio.Constantes.General.Cedula" || data.tipoIdentificacion === "@Dominio.Constantes.General.RucNatural")
                            obtenerReporteNatural(data.idHistorial, identificacion);
                        else if (data.tipoIdentificacion === "@Dominio.Constantes.General.RucJuridico" || data.tipoIdentificacion === "@Dominio.Constantes.General.SectorPublico")
                            obtenerReporteJuridico(idHistorialTemp, identificacion);
                        else {
                            Swal.fire("¡Error!", `El tipo de identificación no es válido`, "error");
                            limpiar();
                            return false;
                        }
                        obtenerPermisoEvaluacion();
                        obtenerPermisoBuroCredito();
                    },
                    error: function (error) {
                        $('#btnBuscar').prop('disabled', false);
                        $('#btnLimpiar').prop('disabled', false);
                        $('#btnImprimir').prop('disabled', false);
                        $('#btnEvaluar').prop('disabled', false);
                        $('#btnBuscarBuroCreditoNuevo').prop('disabled', false);
                        $('#btnBuscarPrediosNuevo').prop('disabled', false);
                        $('#btnBuscarAntecedentesNuevo').prop('disabled', false);
                        $('#btnBuscarFiscaliaNuevo').prop('disabled', true);
                        $('#btnBuscarImpedimentoNuevo').prop('disabled', false);
                        $('#btnBuscarUafeNuevo').prop('disabled', false);
                        //$('#btnBuscarSuperBancosNuevo').prop('disabled', false);
                        $('#btnBuscarNombreModal').prop('disabled', false);
                        $('#btnBuscarPlacaModal').prop('disabled', false);
                        Swal.fire("¡Error!", error && error.responseJSON ? error.responseJSON.detail : (error && error.responseText ? `No se pudo procesar la validación. ${error.responseText}` : "No se pudo procesar la validación. "), "error");
                        console.log(error);
                    }
                });
            }

            ////////////////////////////////////////////////////////////////////////////
            //Busqueda Nombres
            let swLoadingTablaNombres = false;
            let config = {
                id: "tablaNombres",
                dom: "tipr",
                ajax: {
                    url: '@Url.Action("ListadoNombres", "Principal", new { Area = "Consultas"})',
                    method: "POST",
                    dataType: "json",
                    contentType: "application/json",
                    data: function (d) {
                        let filtros = new Object();
                        filtros.nombre = $("#inputNombre").val();
                        return JSON.stringify(filtros);
                    },
                    dataSrc: function (e) {
                        if (swLoadingTablaNombres)
                            Swal.close();

                        return e;
                    }
                },
                createdRow: function (row, data, dataIndex) {
                    $(row).addClass("tr-info-enlace");
                    $(row).css("cursor", "pointer");
                },
                columns: [
                    { width: '50%', data: "cedula" },
                    { width: '50%', data: "nombre" }
                ],
                drawCallback: function () {
                    tippy(".tr-info-enlace", { content: "Presionar para Consultar" });
                },
                pageLength: 10,
                columnFilter: true,
                orderCellsTop: true,
                fixedHeader: true,
                searchable: false,
                processing: true
            };
            tablaNombres = configDatatable(config);

            $("#btnBuscarNombre").click(function () {
                let nombrePersona = $("#inputNombre").val();
                let reg = /(?:[a-zA-ZÀ-ÿ\u00f1\u00d1]+\s){1}[a-zA-ZÀ-ÿ\u00f1\u00d1]+/;
                if (!reg.exec(nombrePersona))
                    Swal.fire("¡Advertencia!", `Es necesario ingresar al menos dos palabras para la búsqueda`, "warning");
                else if (nombrePersona.length <= 2)
                    Swal.fire("¡Advertencia!", `El campo está vacío o el nombre ingresado es muy corto. Ingrese mínimo 3 caracteres`, "warning");
                else if (nombrePersona.trim() === nombreTemp.trim())
                    Swal.fire("¡Advertencia!", `El nombre ingresado no ha cambiado desde la última búsqueda`, "warning");
                else {
                    initLoadingSwal();
                    swLoadingTablaNombres = true;
                    $('#tablaNombres thead input').val('').change();
                    tablaNombres.ajax.reload();
                    nombreTemp = nombrePersona;
                }
            });

            ////////////////////////////////////////////////////////////////////////////
            //Busqueda Placas
            $("#formPlaca").submit(function (e) {
                e.preventDefault();
                let placa = $("#inputPlaca").val();
                let regPlaca = /^[A-Za-z0-9]+$/;
                initLoadingSwal();
                if (placa.length < 7)
                    Swal.fire("¡Advertencia!", `Faltan caracteres en la placa del vehículo`, "warning");
                else if (!regPlaca.exec(placa))
                    Swal.fire("¡Advertencia!", `La placa no cumple con el formato designado. Es obligatorio ingresar las placas con 4 dígitos.`, "warning");
                else
                    $.post({
                        url: "@Url.Action("BuscarPropietarioAuto", "Principal", new { Area = "Consultas"})",
                        data: {
                            "placa": placa,
                        },
                        success: function (data) {
                            if (data !== null) {
                                let tituloPropietario;
                                let textoPropietario;
                                let tipoPropietario;
                                let textHist = "";
                                if (data.historico)
                                    textHist = "[HISTÓRICO]";

                                if (data.tipo.length > 0 && data.tipo == "@Dominio.Constantes.General.Cedula") {
                                    if (data.cedula.length > 0 && data.nombre.length > 0) {
                                        tituloPropietario = `El propietario del vehículo es <br\> ${data.cedula} - ${data.nombre} ${textHist}`;
                                        textoPropietario = 'Confirmo tener el consentimiento expreso e informado de principios, derechos y finalidades para la consulta del titular';
                                        tipoPropietario = function () {
                                            $("#Identificacion").val(data.cedula);
                                            $("#formBalance").submit();
                                            $("#modalBuscarPlaca .close").click();
                                        };
                                    } else if (data.cedula.length === 0 && data.nombre.length > 0) {
                                        tituloPropietario = `El propietario del vehículo es <br\> ${data.nombre} ${textHist}`;
                                        textoPropietario = '¿Desea buscar manualmente la información de esta persona?';
                                        tipoPropietario = function () {
                                            $("#modalBuscarPlaca .close").click();
                                            $("#inputNombre").val(data.nombre);
                                            $("#modalBuscarNombre").modal('show');
                                        };
                                    }
                                    Swal.fire({
                                        title: tituloPropietario,
                                        text: textoPropietario,
                                        icon: 'question',
                                        showCancelButton: true,
                                        confirmButtonText: 'SI',
                                        cancelButtonText: 'NO',
                                        showLoaderOnConfirm: true,
                                        allowOutsideClick: () => !Swal.isLoading(),
                                        preConfirm: tipoPropietario
                                    });
                                }
                                else if (data.tipo.length > 0 && data.tipo == "@Dominio.Constantes.General.Ruc") {
                                    if (data.cedula.length === 0 && data.nombre.length > 0) {
                                        tituloPropietario = `El vehículo pertenece a la empresa <br\> ${data.nombre} ${textHist}`;
                                        textoPropietario = 'No se puede buscar información del propietario.';
                                        tipoPropietario = function () {
                                            $("#modalBuscarPlaca .close").click();
                                        };
                                    }
                                    Swal.fire({
                                        title: tituloPropietario,
                                        text: textoPropietario,
                                        icon: 'info',
                                        showCancelButton: false,
                                        showLoaderOnConfirm: true,
                                        allowOutsideClick: () => !Swal.isLoading(),
                                        preConfirm: tipoPropietario
                                    });
                                } else {
                                    Swal.fire("No se encontró información del propietario", "", "info");
                                }
                            } else {
                                Swal.fire("No se encontró información del propietario", "", "info");
                            }
                        },
                        error: function (error) {
                            Swal.fire("¡Error!", "No se pudo procesar la consulta para el propietario del vehículo.", "error");
                            console.log(error);
                        }
                    });
            });

            ////////////////////////////////////////////////////////////////////////////
            //Resumen
            $("#btnResumen").click(function () {
                if ($('#divResumenConsultas').is(':visible'))
                    $("#divResumenConsultas").hide("fast");
                else
                {
                    obtenerResumenConsultas();
                    $("#divResumenConsultas").show("fast");
                }
            });

            ////////////////////////////////////////////////////////////////////////////
            //Limpiar
            $("#btnLimpiar").click(function () {
                $("#Identificacion").val("");
                $("#IdHistorial").val("");
                $('#divInformacionGeneral').css("display", "none");
                identificacionTemp = "";
                tipoIdentificacionTemp = "";
                idHistorialTemp = 0;
                fechaCedulacionIngreso = false;
            });

            ////////////////////////////////////////////////////////////////////////////
            //Imprimir
            $("#btnImprimir").on("click", function () {
                let idHistorial = $("#IdHistorial").val();
                idHistorial = parseInt(idHistorial);
                if (isNaN(idHistorial))
                    idHistorial = 0;

                if (idHistorial === 0) {
                    Swal.fire("¡Advertencia!", `No se pudo generar el reporte PDF porque no se ha generado la información`, "warning");
                    return false;
                }

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("ObtenerReporteConsultas", "Principal", new { Area = "Consultas"})",
                    data: { 'idHistorial': idHistorial },
                    xhrFields: {
                        responseType: 'blob'
                    },
                    datatype: "json",
                    beforeSend: function () {
                        initLoadingSwal("Generando Reporte PDF...");
                        $('#btnImprimir').prop('disabled', true);
                    },
                    success: function (data) {
                        if (data) {
                            let a = document.createElement('a');
                            let url = window.URL.createObjectURL(data);
                            a.href = url;
                            a.download = `ReporteAnálisisInformación360_${$("#Identificacion").val()}`;
                            document.body.append(a);
                            a.click();
                            a.remove();
                            window.URL.revokeObjectURL(url);
                            swal.close();
                            $('#btnImprimir').prop('disabled', false);
                        } else {
                            Swal.fire("¡Error!", "No se pudo generar el reporte PDF", "error");
                            $('#btnImprimir').prop('disabled', false);
                        }
                    },
                    error: function (error) {
                        Swal.fire("¡Error!", error && error.responseJSON ? error.responseJSON.detail : (error && error.responseText ? `No se pudo generar el reporte PDF. ${error.responseText}` : `No se pudo generar el reporte PDF. `), "error");
                        $('#btnImprimir').prop('disabled', false);
                    }
                });
            });

            ////////////////////////////////////////////////////////////////////////////
            //Eventos Pestañas
            $("#tab-cont-sri").on("click", "#btnBuscarSri", function () {
                boolSri = true;
                if (idHistorialTemp > 0) {
                    obtenerSriRespaldo(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-civil").on("click", "#btnBuscarCivil", function () {
                boolCivil = true;
                if (idHistorialTemp > 0) {
                    obtenerCivilRespaldo(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-civil").on("click", "#btnBuscarFamilia", function () {                
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: 'Considere que esta información es histórica ¿Desea continuar?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'SI',
                        cancelButtonText: 'NO',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            obtenerCivilFamilia(idHistorialTemp, identificacionTemp);
                        }
                    });                    
                }
            });

            $("#tab-cont-societario").on("click", "#btnBuscarBalance", function () {
                boolBalance = true;
                if (idHistorialTemp > 0) {
                    obtenerBalanceRespaldo(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-iess").on("click", "#btnBuscarObligacion", function () {
                boolIess = true;
                if (idHistorialTemp > 0) {
                    obtenerIess(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-iess").on("click", "#btnBuscarAfiliado", function () {
                boolIess = true;
                if (idHistorialTemp > 0) {
                    obtenerIess(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-senescyt").on("click", "#btnBuscarSenescyt", function () {
                boolSenescyt = true;
                if (idHistorialTemp > 0) {
                    obtenerSenescyt(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-legal").on("click", "#btnBuscarLegal", function () {
                boolLegal = true;
                if (idHistorialTemp > 0) {
                    obtenerJudicial(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-legal").on("click", "#btnBuscarImpedimento", function () {
                if (idHistorialTemp > 0) {
                    obtenerCertificadoImpedimento(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-legal").on("click", "#btnBuscarImpedimentoNuevo", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Desea consultar el Certificado de Impedimento para la persona o representante legal?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'SI',
                        cancelButtonText: 'NO',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            $("#divBusquedaImpedimento").css("display", "none");
                            obtenerCertificadoImpedimento(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-ant").on("click", "#btnBuscarAnt", function () {
                boolAnt = true;
                if (idHistorialTemp > 0) {
                    obtenerAnt(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-sercop").on("click", "#btnBuscarSercop", function () {
                boolSercop = true;
                if (idHistorialTemp > 0) {
                    obtenerSercop(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-pensionalimenticia").on("click", "#btnBuscarPensionAlimenticia", function () {
                boolPensionAlimenticia = true;
                if (idHistorialTemp > 0) {
                    obtenerPensionAlimenticia(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-superbancos").on("click", "#btnBuscarSuperBancos", function () {
                boolSuperBancos = true;
                if (idHistorialTemp > 0) {
                    obtenerSuperBancos(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-superbancos").on("click", "#btnBuscarSuperBancosCedula", function () {
                if (idHistorialTemp > 0) {
                    obtenerSuperBancosCedula(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-superbancos").on("click", "#btnBuscarSuperBancosNatural", function () {
                if (idHistorialTemp > 0) {
                    obtenerSuperBancosNatural(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-superbancos").on("click", "#btnBuscarSuperBancosEmpresa", function () {
                if (idHistorialTemp > 0) {
                    obtenerSuperBancosEmpresa(idHistorialTemp, identificacionTemp);
                }
            });

            //$("#tab-cont-superbancos").on("click", "#btnBuscarSuperBancosNuevo", function () {
            //    if (idHistorialTemp > 0) {
            //        Swal.fire({
            //            title: '¿Está seguro que desea realizar esta consulta?',
            //            icon: 'question',
            //            showCancelButton: true,
            //            confirmButtonText: 'OK',
            //            cancelButtonText: 'Cancelar',
            //            showLoaderOnConfirm: true,
            //            allowOutsideClick: () => !Swal.isLoading(),
            //            preConfirm: function () {
            //                $("#divBusquedaSuperBancos").css("display", "none");
            //                obtenerSuperBancos(idHistorialTemp, identificacionTemp);
            //            }
            //        });
            //    }
            //    boolSuperBancos = true;
            //    if (idHistorialTemp > 0) {
            //        obtenerSuperBancos(idHistorialTemp, identificacionTemp);
            //    }
            //});

            $("#tab-cont-antecedentes").on("click", "#btnBuscarAntecedentes", function () {
                if (idHistorialTemp > 0) {
                    obtenerAntecedentes(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-antecedentes").on("click", "#btnBuscarAntecedentesNuevo", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            $("#divBusquedaAntecedentes").css("display", "none");
                            obtenerAntecedentes(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarPredios", function () {
                if (idHistorialTemp > 0) {
                    obtenerPredios(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarPrediosNuevo", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            $("#divBusquedaPredios").css("display", "none");
                            obtenerPredios(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarDetallePredios", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            obtenerDetallePredios(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarDetallePrediosEmpresa", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            obtenerDetallePrediosEmpresa(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarPrediosRepresentante", function () {
                if (idHistorialTemp > 0) {
                    obtenerPrediosRepresentante(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-predios").on("click", "#btnBuscarPrediosEmpresa", function () {
                if (idHistorialTemp > 0) {
                    obtenerPrediosEmpresa(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-fiscalia").on("click", "#btnBuscarFiscalia", function () {
                if (idHistorialTemp > 0) {
                    obtenerFiscaliaDelitos(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-fiscalia").on("click", "#btnBuscarFiscaliaNuevo", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            $("#divBusquedaFiscalia").css("display", "none");
                            obtenerFiscaliaDelitos(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-uafe").on("click", "#btnBuscarUafe", function () {
                if (idHistorialTemp > 0) {
                    obtenerUafe(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-uafe").on("click", "#btnBuscarUafeNuevo", function () {
                if (idHistorialTemp > 0) {
                    Swal.fire({
                        title: '¿Está seguro que desea realizar esta consulta?',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: 'OK',
                        cancelButtonText: 'Cancelar',
                        showLoaderOnConfirm: true,
                        allowOutsideClick: () => !Swal.isLoading(),
                        preConfirm: function () {
                            $("#divBusquedaUafe").css("display", "none");
                            obtenerUafe(idHistorialTemp, identificacionTemp);
                        }
                    });
                }
            });

            $("#tab-cont-buro").on("click", "#btnBuscarBuroCredito", function () {
                if (idHistorialTemp > 0) {
                    if (modeloIndumot)
                        $("#modalBuroIndumot").modal("show");
                    else if (modeloBCapital)
                        $("#modalBuroBCapital").modal("show");
                    else if (modeloCooperativas)
                        $("#modalBuroCooperativas").modal("show");
                    else
                        obtenerBuroCredito(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-buro").on("click", "#btnBuscarBuroCreditoNuevo", function () {
                if (idHistorialTemp > 0) {
                    if (modeloIndumot)
                        $("#modalBuroIndumot").modal("show");
                    else if (modeloBCapital)
                        $("#modalBuroBCapital").modal("show");
                    else if (modeloCooperativas)
                        $("#modalBuroCooperativas").modal("show");
                    else
                        Swal.fire({
                            title: '¿Está seguro que desea realizar la consultar al Buró de Crédito?',
                            text: 'Está consulta tendrá un costo extra de acuerdo a su contrato',
                            icon: 'question',
                            showCancelButton: true,
                            confirmButtonText: 'OK',
                            cancelButtonText: 'Cancelar',
                            showLoaderOnConfirm: true,
                            allowOutsideClick: () => !Swal.isLoading(),
                            preConfirm: function () {
                                $("#divBusquedaBuroCredito").css("display", "none");
                                obtenerBuroCredito(idHistorialTemp, identificacionTemp);
                            }
                        });
                }
            });


            ////////////////////////////////////////////////////////////////////////////
            //Buro Indumot
            $("#formBuroIndumot").submit(function (e) {
                e.preventDefault();

                let identificacionConyuge = $("#modalBuroIndumot").find("#inputIdentificacionConyugeIndumot").val();
                let identificacionGarante = $("#modalBuroIndumot").find("#inputIdentificacionGaranteIndumot").val();
                let tipoProducto = $("#modalBuroIndumot").find("#inputTipoProductoIndumot").val();
                let ingresos = $("#modalBuroIndumot").find("#inputIngresosIndumot").val();
                let gastos = $("#modalBuroIndumot").find("#inputGastosIndumot").val();
                let monto = $("#modalBuroIndumot").find("#inputMontoIndumot").val();
                let plazo = $("#modalBuroIndumot").find("#inputPlazoIndumot").val();
                let valorEntrada = $("#modalBuroIndumot").find("#inputValorEntradaIndumot").val();

                // if (tipoProducto === "") { Swal.fire("¡Advertencia!", "El campo Tipo de Producto es obligatorio", "warning"); return false }
                // if (ingresos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Ingresos es obligatorio", "warning"); return false }
                // if (gastos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Gastos es obligatorio", "warning"); return false }
                if (monto.trim() === "") { Swal.fire("¡Advertencia!", "El campo Monto Solicitado es obligatorio", "warning"); return false }
                if (plazo.trim() === "") { Swal.fire("¡Advertencia!", "El campo Meses Plazo es obligatorio", "warning"); return false }

                Swal.fire({
                    title: '¿Está seguro que desea realizar la consultar al Buró de Crédito (Modelo Experto Indumot)?',
                    text: 'Está consulta tendrá un costo extra de acuerdo a su contrato',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancelar',
                    showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading(),
                    preConfirm: function () {
                        $("#divBusquedaBuroCredito").css("display", "none");
                        obtenerBuroCreditoIndumot(idHistorialTemp, identificacionTemp, identificacionConyuge, identificacionGarante, tipoProducto, ingresos, gastos, monto, plazo, valorEntrada);
                    }
                });
            });

            $('#modalBuroIndumot').on('hidden.bs.modal', function () {
                $("#modalBuroIndumot").find("#formBuroIndumot")[0].reset();
            });

             ////////////////////////////////////////////////////////////////////////////
            //Buro BANCO CAPITAL
            $("#formBuroBCapital").submit(function (e) {
                e.preventDefault();

                let ingresos = $("#modalBuroBCapital").find("#inputIngresosBC").val();
                let gastos = $("#modalBuroBCapital").find("#inputGastosBC").val();
                let monto = $("#modalBuroBCapital").find("#inputMontoBC").val();
                let plazo = $("#modalBuroBCapital").find("#inputPlazoBC").val();
                let tipo = $("#modalBuroBCapital").find("#selectTipoBC").val();
                let mesesExperiencia = $("#modalBuroBCapital").find("#inputMesesExperienciaActividadBC").val();
                let idConyuge = $("#modalBuroBCapital").find("#inputIdentificacionConyugeBC").val();
                let propiedades = $("#modalBuroBCapital").find("#switchPropiedadesBC").is(":checked");

                if (ingresos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Ingresos es obligatorio", "warning"); return false }
                if (gastos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Gastos es obligatorio", "warning"); return false }
                if (monto.trim() === "") { Swal.fire("¡Advertencia!", "El campo Monto Solicitado es obligatorio", "warning"); return false }
                if (plazo.trim() === "") { Swal.fire("¡Advertencia!", "El campo Meses Plazo es obligatorio", "warning"); return false }
                if (tipo === "") { Swal.fire("¡Advertencia!", "El campo Tipo de Préstamo es obligatorio", "warning"); return false }
                if (mesesExperiencia === "") { Swal.fire("¡Advertencia!", "El campo Meses Experiencia Actividad es obligatorio", "warning"); return false }

                if (parseFloat(ingresos) <= 0) { Swal.fire("¡Advertencia!", "Los ingresos deben ser superiores a 0", "warning"); return false }
                if (parseFloat(gastos) < 0) { Swal.fire("¡Advertencia!", "Los gastos deben ser superiores o iguales a 0", "warning"); return false }
                if (parseFloat(gastos) > parseFloat(ingresos)) { Swal.fire("¡Advertencia!", "Los gastos no pueden ser superiores a los ingresos", "warning"); return false }
                if (parseFloat(monto) <= 0) { Swal.fire("¡Advertencia!", "El monto solicitado debe ser superior a 0", "warning"); return false }
                if (parseInt(plazo) <= 0) { Swal.fire("¡Advertencia!", "El plazo debe ser superior a 0", "warning"); return false }

                if (tipo === "@((short)Dominio.Tipos.Clientes.Cliente1090105244001.TipoPrestamoBCapitalAval.LivianosC)" || tipo === "@((short)Dominio.Tipos.Clientes.Cliente1090105244001.TipoPrestamoBCapitalAval.LivianosM)") {
                    if (parseFloat(monto) < 5000 || parseFloat(monto) > 65000) { Swal.fire("¡Advertencia!", "El monto solicitado debe ser entre $ 5.000,00 y $ 65.000,00", "warning"); return false }
                    if (parseInt(plazo) > 72 || parseInt(plazo) < 12) { Swal.fire("¡Advertencia!", "El plazo debe estar entre los 12 y 72 meses", "warning"); return false }
                    if (parseInt(mesesExperiencia)  < 12) { Swal.fire("¡Advertencia!", "Los meses de experiencia de actividad debe ser mayor a 12 meses", "warning"); return false }
                }

                if (tipo === "@((short)Dominio.Tipos.Clientes.Cliente1090105244001.TipoPrestamoBCapitalAval.TrabajoM)") {
                    if (parseFloat(monto) < 5000 || parseFloat(monto) > 90000) { Swal.fire("¡Advertencia!", "El monto solicitado debe ser entre $ 5.000,00 y $ 90.000,00", "warning"); return false }
                    if (parseInt(plazo) > 72 || parseInt(plazo) < 12) { Swal.fire("¡Advertencia!", "El plazo debe estar entre los 12 y 72 meses", "warning"); return false }
                    if (parseInt(mesesExperiencia)  < 24) { Swal.fire("¡Advertencia!", "Los meses de experiencia de actividad debe ser mayor a 24 meses", "warning"); return false } 
                }

                Swal.fire({
                    title: '¿Está seguro que desea realizar la consultar al Buró de Crédito (Modelo Banco Capital)?',
                    text: 'Está consulta tendrá un costo extra de acuerdo a su contrato',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancelar',
                    showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading(),
                    preConfirm: function () {
                        $("#divBusquedaBuroCredito").css("display", "none");
                        obtenerBuroCreditoBancoCapital(idHistorialTemp, identificacionTemp, ingresos, gastos, monto, plazo, tipo, mesesExperiencia, idConyuge, propiedades);
                    }
                });
            });

            $('#modalBuroBCapital').on('hidden.bs.modal', function () {
                $("#modalBuroBCapital").find("#formBuroBCapital")[0].reset();
            });

            ////////////////////////////////////////////////////////////////////////////
            //Buro Cooperativas
            $("#formBuroCooperativas").submit(function (e) {
                e.preventDefault();

                let ingresos = $("#modalBuroCooperativas").find("#inputIngresosCoac").val();
                let gastos = $("#modalBuroCooperativas").find("#inputGastosCoac").val();
                let monto = $("#modalBuroCooperativas").find("#inputMontoCoac").val();
                let plazo = $("#modalBuroCooperativas").find("#inputPlazoCoac").val();
                let tipo = $("#modalBuroCooperativas").find("#selectTipoCoac").val();

                if (ingresos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Ingresos es obligatorio", "warning"); return false }
                if (gastos.trim() === "") { Swal.fire("¡Advertencia!", "El campo Gastos es obligatorio", "warning"); return false }
                if (monto.trim() === "") { Swal.fire("¡Advertencia!", "El campo Monto Solicitado es obligatorio", "warning"); return false }
                if (plazo.trim() === "") { Swal.fire("¡Advertencia!", "El campo Meses Plazo es obligatorio", "warning"); return false }
                if (tipo === "") { Swal.fire("¡Advertencia!", "El campo Tipo de Préstamo es obligatorio", "warning"); return false }

                if (parseFloat(ingresos) <= 0) { Swal.fire("¡Advertencia!", "Los ingresos deben ser superiores a 0", "warning"); return false }
                if (parseFloat(gastos) < 0) { Swal.fire("¡Advertencia!", "Los gastos deben ser superiores o iguales a 0", "warning"); return false }
                if (parseFloat(gastos) > parseFloat(ingresos)) { Swal.fire("¡Advertencia!", "Los gastos no pueden ser superiores a los ingresos", "warning"); return false }
                if (parseFloat(monto) <= 0) { Swal.fire("¡Advertencia!", "El monto solicitado debe ser superior a 0", "warning"); return false }
                if (parseInt(plazo) <= 0) { Swal.fire("¡Advertencia!", "El plazo debe ser superior a 0", "warning"); return false }

                if (tipo === "@((short)Dominio.Tipos.TipoPrestamoCooperativasAval.Consumo)") {
                    if (parseFloat(monto) < 110 || parseFloat(monto) > 120000) { Swal.fire("¡Advertencia!", "El monto solicitado para consumo debe ser entre $ 110,00 y $ 120.000,00", "warning"); return false }
                    if (parseInt(plazo) > 120) { Swal.fire("¡Advertencia!", "El plazo para consumo no debe superar los 120 meses", "warning"); return false }
                }

                if (tipo === "@((short)Dominio.Tipos.TipoPrestamoCooperativasAval.Microcredito)") {
                    if (parseFloat(monto) < 80 || parseFloat(monto) > 120000) { Swal.fire("¡Advertencia!", "El monto solicitado para microcrédito debe ser entre $ 80,00 y $ 120.000,00", "warning"); return false }
                    if (parseInt(plazo) > 120) { Swal.fire("¡Advertencia!", "El plazo  para microcrédito no debe superar los 120 meses", "warning"); return false }
                }

                Swal.fire({
                    title: '¿Está seguro que desea realizar la consultar al Buró de Crédito (Modelo de Cooperativas 4 y 5)?',
                    text: 'Está consulta tendrá un costo extra de acuerdo a su contrato',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancelar',
                    showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading(),
                    preConfirm: function () {
                        $("#divBusquedaBuroCredito").css("display", "none");
                        obtenerBuroCreditoCooperativas(idHistorialTemp, identificacionTemp, ingresos, gastos, monto, plazo, tipo);
                    }
                });
            });

            $('#modalBuroCooperativas').on('hidden.bs.modal', function () {
                $("#modalBuroCooperativas").find("#formBuroCooperativas")[0].reset();
            });

            ////////////////////////////////////////////////////////////////////////////     
            //Evaluacion
            $("#tab-cont-evaluacion").on("click", "#btnEvaluar", function () {
                obtenerCalificacion();
            });

            $("#formBuroIndumot").on("click", "input", function () {
                $(this).val("");
            });

            $("#btnEvaluar").click(function () {
                obtenerCalificacion();
            });
            ////////////////////////////////////////////////////////////////////////////
            //Otros Eventos
            $('#modalBuscarNombre').on('hidden.bs.modal', function (e) {
                $("#inputNombre").val("");
                nombreTemp = "";
                tablaNombres.clear().draw();
                $('#tablaNombres thead input').val('').change();
            });

            $('#modalBuscarPlaca').on('hidden.bs.modal', function (e) {
                $("#inputPlaca").val("");
            });

            $('#tablaNombres tbody').on('click', 'tr', function () {
                let data = tablaNombres.row(this).data();
                Swal.fire({
                    title: `Ha seleccionado a <br\> ${data.cedula} - ${data.nombre}`,
                    text: 'Confirmo tener el consentimiento expreso e informado de principios, derechos y finalidades para la consulta del titular',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: 'OK',
                    cancelButtonText: 'Cancelar',
                    showLoaderOnConfirm: true,
                    allowOutsideClick: () => !Swal.isLoading(),
                    preConfirm: function () {
                        $("#Identificacion").val(data.cedula);
                        $("#formBalance").submit();
                        $("#modalBuscarNombre .close").click();
                    }
                });
            });

            $(document).on('show.bs.modal', '.modal', function () {
                $(".modal").appendTo('body');
            });

              //Imprimir solicitud credito
            $("#btnImprimirSolicitudCredito").on("click", function () {
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("ObtenerSolicitudCredito", "Principal", new { Area = "Consultas"})",
                    data: { 'idHistorial': idHistorialTemp },
                    xhrFields: {
                        responseType: 'blob'
                    },
                    datatype: "json",
                    beforeSend: function () {
                        initLoadingSwal("Generando Reporte PDF...");
                    },
                    success: function (data) {
                        if (data) {
                            let a = document.createElement('a');
                            let url = window.URL.createObjectURL(data);
                            a.href = url;
                            a.download = `SolicitudCredito_${$("#Identificacion").val()}`;
                            document.body.append(a);
                            a.click();
                            a.remove();
                            window.URL.revokeObjectURL(url);
                            swal.close();
                        } else
                            Swal.fire("¡Error!", "No se pudo generar el pdf", "error");
                    },
                    error: function (error) {
                        Swal.fire("¡Error!", error && error.responseJSON ? error.responseJSON.detail : (error && error.responseText ? `No se pudo generar el reporte PDF. ${error.responseText}` : "No se pudo generar el reporte PDF. "), "error");
                        console.log(error);
                    }
                });
            });

            //Fuentes Equifax
            $("#tab-cont-buro").on("click", "#btnBuscarNivelTotalDeudaHistorica", function () {
                if (idHistorialTemp > 0) {
                    obtenerNivelTotalDeudaHistorica(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-buro").on("click", "#btnBuscarNivelEvolucionHistorica", function () {
                if (idHistorialTemp > 0) {
                    obtenerNivelEvolucionHistorica(idHistorialTemp, identificacionTemp);
                }
            });

            $("#tab-cont-buro").on("click", "#btnBuscarNivelHistoricoEstructuraVencimientos", function () {
                if (idHistorialTemp > 0) {
                    obtenerNivelHistoricoEstructuraVencimientos(idHistorialTemp, identificacionTemp);
                }
            });
        });

        ////////////////////////////////////////////////////////////////////////////
        //Funciones Fuentes
        let boolSercop = false;
        let boolLegal = false;
        let boolSenescyt = false;
        let boolAnt = false;
        let boolPensionAlimenticia = false;
        let boolIess = false;
        let boolCivil = false;
        let boolSri = false;
        let boolBalance = false;
        let boolSuperBancos = false;

        let i = 0;
        function obtenerReporteNatural(idHistorial, identificacion) {
            $('#tab-societario').hide();
            $('#divInformacionGeneral').show();
            $('.nav-tabs a:first').tab('show');
            obtenerSri(idHistorial, identificacion);
            //obtenerCivil(idHistorial, identificacion);
            //obtenerIess(idHistorial, identificacion);
            //obtenerSenescyt(idHistorial, identificacion);
            //obtenerJudicial(idHistorial, identificacion);
            //obtenerAnt();
            //obtenerSercop(idHistorial, identificacion);
            //obtenerBuroCredito(idHistorial, identificacion);
            //obtenerFiscaliaDelitos(idHistorial, identificacion);
            //obtenerSuperBancos(idHistorial, identificacion);
        }

        function obtenerReporteJuridico(idHistorial, identificacion) {
            $('#tab-societario').show();
            $('#divInformacionGeneral').show();
            $('.nav-tabs a:first').tab('show');
            obtenerSri(idHistorial, identificacion);
            //obtenerCivil(idHistorial, identificacion);
            //obtenerIess(idHistorial, identificacion);
            //obtenerSenescyt(idHistorial, identificacion);
            //obtenerJudicial(idHistorial, identificacion);
            //obtenerBalance(idHistorial, identificacion);
            //obtenerAnt();
            //obtenerSercop(idHistorial, identificacion);
            //obtenerBuroCredito(idHistorial, identificacion);
            //obtenerFiscaliaDelitos(idHistorial, identificacion);
            //obtenerSuperBancos(idHistorial, identificacion);
        }

        function habilitarBoton() {
            i = i + 1;
            //console.log(i);
            if ((tipoIdentificacionTemp === "@Dominio.Constantes.General.RucJuridico" || tipoIdentificacionTemp === "@Dominio.Constantes.General.SectorPublico") && i === 10) {
                actualizarCalificacionTemp = true;
                tipoIdentificacionTempCalificacion = tipoIdentificacionTemp;
                $('#btnBuscar').prop('disabled', false);
                $('#btnLimpiar').prop('disabled', false);
                $('#btnImprimir').prop('disabled', false);
                $('#btnBuscarNombreModal').prop('disabled', false);
                $('#btnBuscarPlacaModal').prop('disabled', false);
                if (estadoPlanEvaluacion) $('#btnEvaluar').prop('disabled', false);
                i = 0;
                tipoIdentificacionTemp = "";
            } else if ((tipoIdentificacionTemp === "@Dominio.Constantes.General.RucNatural" || tipoIdentificacionTemp === "@Dominio.Constantes.General.Cedula") && i === 10) {
                actualizarCalificacionTemp = true;
                tipoIdentificacionTempCalificacion = tipoIdentificacionTemp;
                $('#btnBuscar').prop('disabled', false);
                $('#btnLimpiar').prop('disabled', false);
                $('#btnImprimir').prop('disabled', false);
                $('#btnBuscarNombreModal').prop('disabled', false);
                $('#btnBuscarPlacaModal').prop('disabled', false);
                if (estadoPlanEvaluacion) $('#btnEvaluar').prop('disabled', false);
                i = 0;
                tipoIdentificacionTemp = "";
            }
        }

        function obtenerSri(idHistorial, identificacion) {
            $("#divBarraSRI").show();
            $('#divFuenteSri').html("");
            $("#divBarraCivil").show();
            $('#divFuenteCivil').html("");
            $("#divBarraJudicial").show();
            $('#divFuenteJudicial').html("");
            $("#divBarraSercop").show();
            $('#divFuenteSERCOP').html("");
            $("#divBarraPensionAlimenticia").show();
            $('#divFuentePensionAlimenticia').html("");
            $("#divBarraSenescyt").show();
            $('#divFuenteSenescyt').html("");
            $("#divBarraIess").show();
            $('#divFuenteIess').html("");
            $("#divBarraBalances").show();
            $('#divFuenteBalance').html("");
            $('#divFuenteCalificacion').html(`<div class="row">
                                                                            <div class="col">
                                                                                <div class="alert alert-warning" role="alert" id="divAccesos">
                                                                                    Para poder <b>EVALUAR</b> debe contratar un <b>PLAN</b> de Evaluación.
                                                                                </div>
                                                                            </div>
                                                                        </div>`);
            $("#divBarraBuroCredito").show();
            $('#divFuenteBuroCredito').html("");
            $("#divBarraANT").show();
            $('#divFuenteANT').html("");
            $("#divBarraSuperBancos").show();
            $('#divFuenteSuperBancos').html("");
            $("#divBarraAntecedentes").show();
            $('#divFuenteAntecedentes').html("");
            $("#divBarraPredios").show();
            $('#divFuentePredios').html("");
            $("#divBarraFiscalia").show();
            $('#divFuenteFiscaliaDelitos').html("");
            $("#divBarraUafe").show();
            $('#divFuenteUafe').html("");

            $.post({
                url: "@Url.Action("ObtenerReporteSRI", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    obtenerCivil(idHistorial, identificacion);
                    $("#divBarraSRI").css("display", "none");
                    $('#divFuenteSri').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolSri)
                        habilitarBoton();
                    else
                        boolSri = false;
                },
                error: function (error) {
                    habilitarBoton();
                    obtenerCivil(idHistorial, identificacion);
                    $("#divBarraSRI").css("display", "none");
                    $("#divFuenteSri").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/informacion.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Empresa
                                                                        <span class="badge badge-info pl-1"><a href="https://srienlinea.sri.gob.ec/sri-en-linea/SriRucWeb/ConsultaRuc/Consultas/consultaRuc" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarSri" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);
                    console.log(error);

                    setTimeout(function () {
                        Toast.fire({
                            icon: 'error',
                            title: "¡Error!",
                            text: "No se pudo procesar la consulta para SRI.",
                            timer: 5000,
                        });
                    }, 500);
                }
            });
        }

        function obtenerSriRespaldo(idHistorial, identificacion) {
            $("#divBarraSRI").show();
            $('#divFuenteSri').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteSRI", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraSRI").css("display", "none");
                    $('#divFuenteSri').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolSri) {
                        habilitarBoton();
                    } else {
                        boolSri = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraSRI").css("display", "none");
                    $("#divFuenteSri").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/informacion.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Empresa
                                                                        <span class="badge badge-info pl-1"><a href="https://srienlinea.sri.gob.ec/sri-en-linea/SriRucWeb/ConsultaRuc/Consultas/consultaRuc" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarSri" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para SRI.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerCivil(idHistorial, identificacion) {
            $("#divBarraCivil").show();
            $('#divFuenteCivil').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteCivil", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraCivil").css("display", "none");
                    $('#divFuenteCivil').html(data);
                    $("#divFuenteCivil").find('#divBarraFamilia').css("display", "none");
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolCivil)
                        habilitarBoton();
                    else
                        boolCivil = false;

                    //SuperBancos Manual
                    //$("#divBarraSuperBancos").css("display", "none");
                    //$("#divBusquedaSuperBancos").show();
                    //$('#btnBuscarSuperBancosNuevo').prop('disabled', false);

                    //Predios Manual
                    $("#divBarraPredios").css("display", "none");
                    $("#divBusquedaPredios").show();
                    $('#btnBuscarPrediosNuevo').prop('disabled', false);

                    //Antecedentes Manual
                    // $("#divBarraAntecedentes").css("display", "none");
                    // $("#divBusquedaAntecedentes").show();
                    // $('#btnBuscarAntecedentesNuevo').prop('disabled', false);

                    //Fiscalia Delitos Manual
                    // $("#divBarraFiscalia").css("display", "none");
                    // $("#divBusquedaFiscalia").show();
                    // $('#btnBuscarFiscaliaNuevo').prop('disabled', false);

                    //UAFE Manual
                    // $("#divBarraUafe").css("display", "none");
                    // $("#divBusquedaUafe").show();
                    // $('#btnBuscarUafeNuevo').prop('disabled', false);

                    //Certificado Impedimento
                    $("#divBarraImpedimento").css("display", "none");
                    $("#divBusquedaImpedimento").show();
                    $('#btnBuscarImpedimentoNuevo').prop('disabled', false);

                    obtenerBalance(idHistorial, identificacion);

                    setTimeout(function () {
                        obtenerIess(idHistorial, identificacion);
                    }, 500);

                    setTimeout(function () {
                        obtenerSenescyt(idHistorial, identificacion);
                    }, 1000);

                    setTimeout(function () {
                        obtenerJudicial(idHistorial, identificacion);
                    }, 1500);

                    setTimeout(function () {
                        obtenerAnt(idHistorial, identificacion);
                    }, 2000);

                    setTimeout(function () {
                        obtenerSercop(idHistorial, identificacion);
                    }, 2500);

                    setTimeout(function () {
                        obtenerPensionAlimenticia(idHistorial, identificacion);
                    }, 3000);

                    setTimeout(function () {
                        obtenerSuperBancos(idHistorial, identificacion);
                    }, 3500);

                    setTimeout(function () {
                        obtenerAntecedentes(idHistorial, identificacion);
                    }, 4000);

                    setTimeout(function () {
                        obtenerFiscaliaDelitos(idHistorial, identificacion);
                    }, 4500);

                    setTimeout(function () {
                        obtenerUafe(idHistorial, identificacion);
                    }, 5000);
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraCivil").css("display", "none");
                    $("#divFuenteCivil").find('#divBarraFamilia').css("display", "none");
                    $("#divFuenteCivil").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/ciudadano.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Civil
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarCivil" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Civil.",
                        timer: 5000,
                    });
                    console.log(error);

                    //SuperBancos Manual
                    //$("#divBarraSuperBancos").css("display", "none");
                    //$("#divBusquedaSuperBancos").show();
                    //$('#btnBuscarSuperBancosNuevo').prop('disabled', false);

                    //Predios Manual
                    $("#divBarraPredios").css("display", "none");
                    $("#divBusquedaPredios").show();
                    $('#btnBuscarPrediosNuevo').prop('disabled', false);

                    //Antecedentes Manual
                    // $("#divBarraAntecedentes").css("display", "none");
                    // $("#divBusquedaAntecedentes").show();
                    // $('#btnBuscarAntecedentesNuevo').prop('disabled', false);

                    //Fiscalia Delitos Manual
                    // $("#divBarraFiscalia").css("display", "none");
                    // $("#divBusquedaFiscalia").show();
                    // $('#btnBuscarFiscaliaNuevo').prop('disabled', false);

                    //UAFE Manual
                    // $("#divBarraUafe").css("display", "none");
                    // $("#divBusquedaUafe").show();
                    // $('#btnBuscarUafeNuevo').prop('disabled', false);

                    //Certificado Impedimento
                    $("#divBarraImpedimento").css("display", "none");
                    $("#divBusquedaImpedimento").show();
                    $('#btnBuscarImpedimentoNuevo').prop('disabled', false);

                    obtenerBalance(idHistorial, identificacion);

                    setTimeout(function () {
                        obtenerIess(idHistorial, identificacion);
                    }, 500);

                    setTimeout(function () {
                        obtenerSenescyt(idHistorial, identificacion);
                    }, 1000);

                    setTimeout(function () {
                        obtenerJudicial(idHistorial, identificacion);
                    }, 1500);

                    setTimeout(function () {
                        obtenerAnt(idHistorial, identificacion);
                    }, 2000);

                    setTimeout(function () {
                        obtenerSercop(idHistorial, identificacion);
                    }, 2500);

                    setTimeout(function () {
                        obtenerPensionAlimenticia(idHistorial, identificacion);
                    }, 3000);

                    setTimeout(function () {
                        obtenerSuperBancos(idHistorial, identificacion);
                    }, 3500);

                    setTimeout(function () {
                        obtenerAntecedentes(idHistorial, identificacion);
                    }, 4000);

                    setTimeout(function () {
                        obtenerFiscaliaDelitos(idHistorial, identificacion);
                    }, 4500);

                    setTimeout(function () {
                        obtenerUafe(idHistorial, identificacion);
                    }, 5000);
                }
            });
        }

        function obtenerCivilRespaldo(idHistorial, identificacion) {
            $("#divBarraCivil").show();
            $('#divFuenteCivil').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteCivil", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraCivil").css("display", "none");
                    $('#divFuenteCivil').html(data);
                    $("#divFuenteCivil").find('#divBarraFamilia').css("display", "none");
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolCivil) {
                        habilitarBoton();
                    } else {
                        boolCivil = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraCivil").css("display", "none");
                    $("#divFuenteCivil").find('#divBarraFamilia').css("display", "none");
                    $("#divFuenteCivil").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/ciudadano.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Civil
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarCivil" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Civil.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerCivilFamilia(idHistorial, identificacion) {
            $("#divObtenerFamilia").css("display", "none");
            $("#divFuenteCivil").find("#divBarraFamilia").show();
            $('#divFuenteFamilia').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteArbolFamiliar", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divFuenteCivil").find("#divBarraFamilia").css("display", "none");
                    $('#divFuenteFamilia').html(data);
                    $('[data-toggle="popover"]').popover({
                        html: true
                    });
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });                    
                },
                error: function (error) {
                    $("#divFuenteCivil").find("#divBarraFamilia").css("display", "none");
                    $("#divFuenteFamilia").html(`<div class="row">
                                                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                                                        <div class="row">
                                                            <div class="col-12 d-flex justify-content-end">
                                                                <button type="button" class="btn btn-primary-custom btn-primary-custom d-inline-flex my-1" id="btnBuscarFamilia"><i class="fa-solid fa-magnifying-glass-plus my-auto mr-1"></i><span class="d-none d-sm-block my-auto">CONSULTAR</span></button>
                                                            </div>
                                                            <div class="col-12">
                                                                <div class="alert alert-warning my-1">
                                                                    <span>Presione el botón <b>CONSULTAR</b> para iniciar el procesamiento de la fuente de información.</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Genealogía Histórica.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerBalance(idHistorial, identificacion) {
            $("#divBarraBalances").show();
            $('#divFuenteBalance').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBalance", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraBalances").css("display", "none");
                    $('#divFuenteBalance').html(data);
                    $("#divBarraBuroCredito").css("display", "none")
                    $("#divBusquedaBuroCredito").show();
                    if (estadoPlanBuroCredito) $('#btnBuscarBuroCreditoNuevo').prop('disabled', false);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    mostrarSocietario();
                    habilitarBoton();
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraBuroCredito").css("display", "none")
                    $("#divBusquedaBuroCredito").show();
                    if (estadoPlanBuroCredito) $('#btnBuscarBuroCreditoNuevo').prop('disabled', false);
                    $("#divBarraBalances").css("display", "none");
                    $("#divFuenteBalance").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/balance.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Societaria
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarBalance" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Societario.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerBalanceRespaldo(idHistorial, identificacion) {
            $("#divBarraBalances").show();
            $('#divFuenteBalance').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBalance", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraBalances").css("display", "none");
                    $('#divFuenteBalance').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    habilitarBoton();
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraBalances").css("display", "none");
                    $("#divFuenteBalance").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/balance.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Societaria
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarBalance" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Societario.",
                        timer: 5000,
                    });

                    console.log(error);
                }
            });
        }

        function obtenerIess(idHistorial, identificacion) {
            $("#divBarraIess").show();
            $('#divFuenteIess').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteIESS", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraIess").css("display", "none");
                    $('#divFuenteIess').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolIess) {
                        habilitarBoton();
                    } else {
                        boolIess = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraIess").css("display", "none");
                    $("#divFuenteIess").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/seguro.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información IEES
                                                                        <span class="badge badge-info pl-1"><a href="https://www.iess.gob.ec/empleador-web/pages/morapatronal/certificadoCumplimientoPublico.jsf" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarAfiliado" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para IEES.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerSenescyt(idHistorial, identificacion) {
            $("#divBarraSenescyt").show();
            $('#divFuenteSenescyt').html("");

            if (!boolSenescyt)
                habilitarBoton();
            else
                boolSenescyt = false;

            $.post({
                url: "@Url.Action("ObtenerReporteSenescyt", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraSenescyt").css("display", "none");
                    $('#divFuenteSenescyt').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSenescyt").css("display", "none");
                    $("#divFuenteSenescyt").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/estudios.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Estudios
                                                                        <span class="badge badge-info pl-1"><a href="https://www.senescyt.gob.ec/consulta-titulos-web/faces/vista/consulta/consulta.xhtml" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarSenescyt" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Senescyt.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerJudicial(idHistorial, identificacion) {
            $("#divBarraJudicial").show();
            $('#divFuenteJudicial').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteLegal", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraJudicial").css("display", "none");
                    $('#divFuenteJudicial').html(data);
                    $("#divFuenteJudicial").find('#divBarraImpedimento').css("display", "none");
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolLegal) {
                        habilitarBoton();
                    } else {
                        boolLegal = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraJudicial").css("display", "none");
                    $("#divFuenteJudicial").find('#divBarraImpedimento').css("display", "none");
                    $("#divFuenteJudicial").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/judicialpersona.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Judicial
                                                                        <span class="badge badge-info pl-1"><a href="http://consultas.funcionjudicial.gob.ec/informacionjudicial/public/informacion.jsf" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarLegal" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Legal.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerCertificadoImpedimento(idHistorial, identificacion) {
            $("#divObtenerImpedimento").css("display", "none");
            $("#divFuenteJudicial").find("#divBarraImpedimento").show();
            $('#divFuenteImpedimento').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteImpedimento", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divFuenteJudicial").find("#divBarraImpedimento").css("display", "none");
                    $('#divFuenteImpedimento').html(data);
                    $('[data-toggle="popover"]').popover({
                        html: true
                    });
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divFuenteJudicial").find("#divBarraImpedimento").css("display", "none");
                    $("#divFuenteImpedimento").html(`<div class="row" id="divBusquedaImpedimento">
                    <div class="col">
                        <div class="card">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-lg-11 col-md-9 col-sm-8 col-9 d-inline-flex">
                                        <img src="../images/iconos/certificadoImpedimento.svg" alt="" width="40" height="40">
                                        <span class="pl-2 my-auto">
                                            Registro de Impedimentos Legales para Ejercer Cargos Públicos
                                            <span class="badge badge-info pl-1"><a href="https://calculadoras.trabajo.gob.ec/impedimento" target="_blank" data-tippy-content="Página Oficial Certificado Impedimento">Página Oficial</a></span>
                                        </span>
                                    </div>
                                    <div class="col-lg-1 col-md-3 col-sm-4 col-3 d-flex justify-content-end">
                                        <button type="button" class="btn btn-primary-custom btn-primary-custom d-inline-flex my-1" id="btnBuscarImpedimentoNuevo"><i class="fa-solid fa-magnifying-glass-plus my-auto mr-1"></i><span class="d-none d-sm-block my-auto">CONSULTAR</span></button>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row" id="divObtenerImpedimento">
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="alert alert-warning my-1">
                                                    <span>Presione el botón <b>CONSULTAR</b> para iniciar el procesamiento de la fuente de información.</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para el Registro de Impedimentos Legales para Ejercer Cargos Públicos.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerAnt(idHistorial, identificacion) {
            $("#divBarraANT").show();
            $('#divFuenteANT').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteANT", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraANT").css("display", "none");
                    $('#divFuenteANT').html(data);
                    $('[data-toggle="popover"]').popover({
                        html: true
                    });
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolAnt) {
                        habilitarBoton();
                    } else {
                        boolAnt = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraANT").css("display", "none");
                    $("#divFuenteANT").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/licencia.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información de Licencia de Conducir
                                                                        <span class="badge badge-info pl-1"><a href="https://consultaweb.ant.gob.ec/PortalWEB/paginas/clientes/clp_criterio_consulta.jsp" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarAnt" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para ANT.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerSercop(idHistorial, identificacion) {
            $("#divBarraSercop").show();
            $('#divFuenteSERCOP').html("");

            if (!boolSercop)
                habilitarBoton();
            else
                boolSercop = false;

            $.post({
                url: "@Url.Action("ObtenerReporteSERCOP", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraSercop").css("display", "none");
                    $('#divFuenteSERCOP').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSercop").css("display", "none");
                    $("#divFuenteSERCOP").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/proveedor.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Proveedores Incumplidos
                                                                        <span class="badge badge-info pl-1"><a href="https://www.compraspublicas.gob.ec/ProcesoContratacion/compras/EP/EmpReporteIncumplidos.cpe?sg=1" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarSercop" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para SERCOP.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerPensionAlimenticia(idHistorial, identificacion) {
            $("#divBarraPensionAlimenticia").show();
            $('#divFuentePensionAlimenticia').html("");
            $.post({
                url: "@Url.Action("ObtenerReportePensionAlimenticia", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraPensionAlimenticia").css("display", "none");
                    $('#divFuentePensionAlimenticia').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    if (!boolPensionAlimenticia) {
                        habilitarBoton();
                    } else {
                        boolPensionAlimenticia = false;
                    }
                },
                error: function (error) {
                    habilitarBoton();
                    $("#divBarraPensionAlimenticia").css("display", "none");
                    $("#divFuentePensionAlimenticia").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/pensionAlimenticia.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información de Pensión Alimenticia
                                                                        <span class="badge badge-info pl-1"><a href="http://supa.funcionjudicial.gob.ec/pensiones/publico/consulta.jsf" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarPensionAlimenticia" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Pensiones Alimenticias.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerSuperBancos(idHistorial, identificacion) {
            $("#divBarraSuperBancos").show();
            $('#divFuenteSuperBancos').html("");

            if (!boolSuperBancos)
                habilitarBoton();
            else
                boolSuperBancos = false;

            $.post({
                url: "@Url.Action("ObtenerReporteSuperBancos", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraSuperBancos").css("display", "none");
                    $('#divFuenteSuperBancos').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSuperBancos").css("display", "none");
                    $("#divFuenteSuperBancos").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/superBancosCedula.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                         Estado de Titulares de Cuenta Corriente
                                                                        <span class="badge badge-info pl-1"><a href="https://appweb.superbancos.gob.ec/ssl/registro/registro.jsf?service=https://appweb.superbancos.gob.ec:443/ssl" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarSuperBancos" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Superintendencia de Bancos.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerSuperBancosCedula(idHistorial, identificacion) {
            $('#divSuperBancosCedulaReintento').html("");
            $("#divSuperBancosCedula").css("display", "none");
            $("#divBarraSuperBancosCedula").show();

            let fechaCedulacion;
            if (typeof $("#inputFechaCedulacion") !== undefined && $("#inputFechaCedulacion").val() !== null) {
                fechaCedulacion = $("#inputFechaCedulacion").datepicker({ dateFormat: 'dd/mm/yyyy' }).val();
                fechaCedulacionIngreso = true;
            }

            $.post({
                url: "@Url.Action("ObtenerReporteSuperBancosCedula", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                    "fechaCedulacion": fechaCedulacion
                },
                success: function (data) {
                    $("#divBarraSuperBancosCedula").css("display", "none");
                    $('#divSuperBancosCedulaReintento').html(data);
                    $('#divSuperBancosCedulaReintento').show();
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSuperBancosCedula").css("display", "none");
                    $('#divSuperBancosCedulaReintento').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    $('#divSuperBancosCedulaReintento').show();
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para SuperBancos.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerSuperBancosNatural(idHistorial, identificacion) {
            $('#divSuperBancosNaturalReintento').html("");
            $("#divSuperBancosNatural").css("display", "none");
            $("#divBarraSuperBancosNatural").show();

            let fechaCedulacion;
            if (typeof $("#inputFechaCedulacion") !== undefined && $("#inputFechaCedulacion").val() !== null && !fechaCedulacionIngreso)
                fechaCedulacion = $("#inputFechaCedulacion").datepicker({ dateFormat: 'dd/mm/yyyy' }).val();

            $.post({
                url: "@Url.Action("ObtenerReporteSuperBancosNatural", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                    "fechaCedulacion": fechaCedulacion
                },
                success: function (data) {
                    $("#divBarraSuperBancosNatural").css("display", "none");
                    $('#divSuperBancosNaturalReintento').html(data);
                    $('#divSuperBancosNaturalReintento').show();
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSuperBancosNatural").css("display", "none");
                    $('#divSuperBancosNaturalReintento').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    $('#divSuperBancosNaturalReintento').show();
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para SuperBancos.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerSuperBancosEmpresa(idHistorial, identificacion) {
            $('#divSuperBancosEmpresaReintento').html("");
            $("#divSuperBancosEmpresa").css("display", "none");
            $("#divBarraSuperBancosEmpresa").show();

            $.post({
                url: "@Url.Action("ObtenerReporteSuperBancosEmpresa", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraSuperBancosEmpresa").css("display", "none");
                    $('#divSuperBancosEmpresaReintento').html(data);
                    $('#divSuperBancosEmpresaReintento').show();
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraSuperBancosEmpresa").css("display", "none");
                    $('#divSuperBancosEmpresaReintento').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    $('#divSuperBancosEmpresaReintento').show();
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para SuperBancos.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerAntecedentes(idHistorial, identificacion) {
            $("#divBarraAntecedentes").show();
            $('#divFuenteAntecedentes').html("");

            $.post({
                url: "@Url.Action("ObtenerReporteAntecedentesPenales", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraAntecedentes").css("display", "none");
                    $('#divFuenteAntecedentes').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraAntecedentes").css("display", "none");
                    $("#divFuenteAntecedentes").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/antecedentes.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Antecedentes Penales
                                                                        <span class="badge badge-info pl-1"><a href="https://certificados.ministeriodelinterior.gob.ec/gestorcertificados/antecedentes/" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarAntecedentes" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Antecedentes Penales.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerPredios(idHistorial, identificacion) {
            let tipoFuente = parseInt($("#selectFuentePredios").val());
            let url = "";
            switch (tipoFuente) {
                case 1:
                    url = "@Url.Action("ObtenerReportePredios", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 2:
                    url = "@Url.Action("ObtenerReportePrediosCuenca", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 3:
                    url = "@Url.Action("ObtenerReportePrediosSantoDomingo", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 4:
                    url = "@Url.Action("ObtenerReportePrediosRuminahui", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 5:
                    url = "@Url.Action("ObtenerReportePrediosQuininde", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 6:
                    url = "@Url.Action("ObtenerReportePrediosLatacunga", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 7:
                    url = "@Url.Action("ObtenerReportePrediosManta", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 8:
                    url = "@Url.Action("ObtenerReportePrediosAmbato", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 9:
                    url = "@Url.Action("ObtenerReportePrediosIbarra", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 10:
                    url = "@Url.Action("ObtenerReportePrediosSanCristobal", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 11:
                    url = "@Url.Action("ObtenerReportePrediosDuran", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 12:
                    url = "@Url.Action("ObtenerReportePrediosLagoAgrio", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 13:
                    url = "@Url.Action("ObtenerReportePrediosSantaRosa", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 14:
                    url = "@Url.Action("ObtenerReportePrediosSucua", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 15:
                    url = "@Url.Action("ObtenerReportePrediosSigSig", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 16:
                    url = "@Url.Action("ObtenerReportePrediosMejia", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 17:
                    url = "@Url.Action("ObtenerReportePrediosMorona", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 18:
                    url = "@Url.Action("ObtenerReportePrediosTena", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 19:
                    url = "@Url.Action("ObtenerReportePrediosCatamayo", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 20:
                    url = "@Url.Action("ObtenerReportePrediosLoja", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 21:
                    url = "@Url.Action("ObtenerReportePrediosSamborondon", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
            }
            tipoFuentePredios = tipoFuente;

            var tipoFuenteAux = $("#divFuentePredios").find("#selectFuentePredios").val();
            if (tipoFuenteAux !== null && tipoFuenteAux !== undefined) {
                tipoFuenteAux = parseInt(tipoFuenteAux);
                switch (tipoFuenteAux) {
                    case 1:
                        url = "@Url.Action("ObtenerReportePredios", "PrincipalDemo", new { Area = "Consultas"})";
                        break;
                    case 2:
                        url = "@Url.Action("ObtenerReportePrediosCuenca", "PrincipalDemo", new { Area = "Consultas"})";
                        break;
                    case 3:
                        url = "@Url.Action("ObtenerReportePrediosSantoDomingo", "PrincipalDemo", new { Area = "Consultas"})";
                        break;
                    case 4:
                        url = "@Url.Action("ObtenerReportePrediosRuminahui", "PrincipalDemo", new { Area = "Consultas"})";
                        break;
                    case 5:
                        url = "@Url.Action("ObtenerReportePrediosQuininde", "PrincipalDemo", new { Area = "Consultas"})";
                        break;
                    case 6:
                        url = "@Url.Action("ObtenerReportePrediosLatacunga", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 7:
                        url = "@Url.Action("ObtenerReportePrediosManta", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 8:
                        url = "@Url.Action("ObtenerReportePrediosAmbato", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 9:
                        url = "@Url.Action("ObtenerReportePrediosIbarra", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 10:
                        url = "@Url.Action("ObtenerReportePrediosSanCristobal", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 11:
                        url = "@Url.Action("ObtenerReportePrediosDuran", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 12:
                        url = "@Url.Action("ObtenerReportePrediosLagoAgrio", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 13:
                        url = "@Url.Action("ObtenerReportePrediosSantaRosa", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 14:
                        url = "@Url.Action("ObtenerReportePrediosSucua", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 15:
                        url = "@Url.Action("ObtenerReportePrediosSigSig", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 16:
                        url = "@Url.Action("ObtenerReportePrediosMejia", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 17:
                        url = "@Url.Action("ObtenerReportePrediosMorona", "PrincipalDemo", new { Area = "Consultas" })";
                        break; 
                    case 18:
                        url = "@Url.Action("ObtenerReportePrediosTena", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 19:
                        url = "@Url.Action("ObtenerReportePrediosCatamayo", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 20:
                        url = "@Url.Action("ObtenerReportePrediosLoja", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                    case 21:
                        url = "@Url.Action("ObtenerReportePrediosSamborondon", "PrincipalDemo", new { Area = "Consultas" })";
                        break;
                }
                tipoFuentePredios = tipoFuenteAux;
            }

            $("#divBarraPredios").show();
            $('#divFuentePredios').html("");

            $.post({
                url: url,
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraPredios").css("display", "none");
                    $('#divFuentePredios').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraPredios").css("display", "none");
                    $("#divFuentePredios").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-6 col-md-12 col-sm-12 d-inline-flex">
                                                                    <img src="../images/iconos/predios.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Predios Personales
                                                                        <span class="badge badge-info pl-1"><a href="https://pam.quito.gob.ec/ConsultadeImpuestos/" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-6 col-md-12 col-sm-12 d-inline-flex justify-content-end">
                                                                    <div class="input-group d-inline-flex justify-content-end mr-2">
                                                                        <div class="input-group-prepend">
                                                                            <div class="input-group-text font-weight-bold" style="font-size: 14px;"><span class="mr-1"><i class="fas fa-info-circle text-primary"></i></span>Seleccionar Cantón: </div>
                                                                        </div>
                                                                        <select class="form-control col-lg-4 col-md-4 col-sm-12" id="selectFuentePredios">
                                                                            <option value="1">Quito</option>
                                                                            <option value="2">Cuenca</option>
                                                                            <option value="3">Santo Domingo</option>
                                                                            <option value="4">Rumiñahui</option>
                                                                            <option value="5">Quinindé</option>
                                                                            <option value="6">Latacunga</option>
                                                                            <option value="7">Manta</option>
                                                                            <option value="8">Ambato</option>
                                                                            <option value="9">Ibarra</option>
                                                                            <option value="10">San Cristóbal</option>
                                                                            <option value="11">Durán</option>
                                                                            <option value="12">Lago Agrio</option>
                                                                            <option value="13">Santa Rosa</option>
                                                                            <option value="14">Sucúa</option>
                                                                            <option value="15">Sígsig</option>
                                                                            <option value="16">Mejía</option>
                                                                            <option value="17">Morona</option>
                                                                            <option value="18">Tena</option>
                                                                            <option value="19">Catamayo</option>
                                                                            <option value="20">Loja</option>
                                                                            <option value="21">Samborondón</option>
                                                                        </select>
                                                                    </div>
                                                                    <button type="button" class="btn btn-primary-custom btn-primary-custom d-inline-flex" id="btnBuscarPredios"><i class="fa-solid fa-magnifying-glass-plus my-auto mr-1"></i><span class="d-none d-sm-none d-md-block">CONSULTAR</span></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Predios.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerDetallePredios(idHistorial, identificacion) {
            $("#divBarraDetallePrediosIrm").show();
            $('#divDetallePrediosIrm').html("");
            $("#divDetallePrediosIrmTemp").css("display", "none");
            $("#btnBuscarDetallePredios").prop('disabled', true);

            $.post({
                url: "@Url.Action("ObtenerReporteDetallePredios", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraDetallePrediosIrm").css("display", "none");
                    $('#divDetallePrediosIrm').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    $("#btnBuscarDetallePredios").prop('disabled', false);
                },
                error: function (error) {
                    $("#btnBuscarDetallePredios").prop('disabled', false);
                    $("#divBarraDetallePrediosIrm").css("display", "none");
                    $('#divDetallePrediosIrm').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Detalle Predios.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerDetallePrediosEmpresa(idHistorial, identificacion) {
            $("#divBarraDetallePrediosIrmEmpresa").show();
            $('#divDetallePrediosIrmEmpresa').html("");
            $("#divDetallePrediosIrmEmpresaTemp").css("display", "none");
            $("#btnBuscarDetallePrediosEmpresa").prop('disabled', true);

            $.post({
                url: "@Url.Action("ObtenerReporteDetallePrediosEmpresa", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraDetallePrediosIrmEmpresa").css("display", "none");
                    $('#divDetallePrediosIrmEmpresa').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    $("#btnBuscarDetallePrediosEmpresa").prop('disabled', false);
                },
                error: function (error) {
                    $("#btnBuscarDetallePrediosEmpresa").prop('disabled', false);
                    $("#divBarraDetallePrediosIrmEmpresa").css("display", "none");
                    $('#divDetallePrediosIrmEmpresa').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Detalle Predios.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerDetallePrediosLoja(idHistorial, identificacion) {
            $("#divBarraDetallePrediosIrmLoja").show();
            $('#divDetallePrediosIrmLoja').html("");
            $("#divDetallePrediosIrmLojaTemp").css("display", "none");
            $("#btnBuscarDetallePrediosLoja").prop('disabled', true);

            $.post({
                url: "@Url.Action("ObtenerReporteDetallePrediosLoja", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraDetallePrediosIrmLoja").css("display", "none");
                    $('#divDetallePrediosIrmLoja').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    $("#btnBuscarDetallePrediosLoja").prop('disabled', false);
                },
                error: function (error) {
                    $("#btnBuscarDetallePrediosLoja").prop('disabled', false);
                    $("#divBarraDetallePrediosIrmLoja").css("display", "none");
                    $('#divDetallePrediosIrmLoja').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Detalle Predios Loja.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerDetallePrediosEmpresaLoja(idHistorial, identificacion) {
            $("#divBarraDetallePrediosIrmEmpresaLoja").show();
            $('#divDetallePrediosIrmEmpresaLoja').html("");
            $("#divDetallePrediosIrmEmpresaLojaTemp").css("display", "none");
            $("#btnBuscarDetallePrediosEmpresaLoja").prop('disabled', true);

            $.post({
                url: "@Url.Action("ObtenerReporteDetallePrediosEmpresaLoja", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                success: function (data) {
                    $("#divBarraDetallePrediosIrmEmpresaLoja").css("display", "none");
                    $('#divDetallePrediosIrmEmpresaLoja').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                    $("#btnBuscarDetallePrediosEmpresaLoja").prop('disabled', false);
                },
                error: function (error) {
                    $("#btnBuscarDetallePrediosEmpresaLoja").prop('disabled', false);
                    $("#divBarraDetallePrediosIrmEmpresaLoja").css("display", "none");
                    $('#divDetallePrediosIrmEmpresaLoja').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Detalle Predios Loja.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerPrediosRepresentante(idHistorial, identificacion) {
            $('#divPrediosRepresentanteReintento').html("");
            $("#divPrediosRepresentante").html("");
            $("#divPrediosRepresentante").css("display", "none");
            $("#divBarraPrediosRepresentante").show();
            $('#btnBuscarPrediosRepresentante').prop('disabled', true);

            let url = "";
            switch (tipoFuentePredios) {
                case 1:
                    url = "@Url.Action("ObtenerReportePrediosRepresentante", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 2:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteCuenca", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 3:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSantoDomingo", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 4:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteRuminahui", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 5:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteQuininde", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 6:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteLatacunga", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 7:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteManta", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 8:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteAmbato", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 9:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteIbarra", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 10:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSanCristobal", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 11:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteDuran", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 12:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteLagoAgrio", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 13:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSantaRosa", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 14:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSucua", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 15:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSigSig", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 16:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteMejia", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 17:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteMorona", "PrincipalDemo", new { Area = "Consultas" })";
                    break;                
                case 18:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteTena", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 19:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteCatamayo", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 20:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteLoja", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 21:
                    url = "@Url.Action("ObtenerReportePrediosRepresentanteSamborondon", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
            }

            $.post({
                url: url,
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraPrediosRepresentante").css("display", "none");
                    $('#divPrediosRepresentanteReintento').html(data);
                    $('#divPrediosRepresentanteReintento').show();
                    $('#btnBuscarPrediosRepresentante').prop('disabled', false);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraPrediosRepresentante").css("display", "none");
                    $('#divPrediosRepresentanteReintento').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    $('#divPrediosRepresentanteReintento').show();
                    $('#btnBuscarPrediosRepresentante').prop('disabled', false);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Predios.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerPrediosEmpresa(idHistorial, identificacion) {
            $('#divPrediosEmpresaReintento').html("");
            $("#divPrediosEmpresa").html("");
            $("#divPrediosEmpresa").css("display", "none");
            $("#divBarraPrediosEmpresa").show();
            $('#btnBuscarPrediosEmpresa').prop('disabled', true);

            let url = "";
            switch (tipoFuentePredios) {
                case 1:
                    url = "@Url.Action("ObtenerReportePrediosEmpresa", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 2:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaCuenca", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 3:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSantoDomingo", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 4:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaRuminahui", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 5:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaQuininde", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 6:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaLatacunga", "PrincipalDemo", new { Area = "Consultas"})";
                    break;
                case 7:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaManta", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 8:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaAmbato", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 9:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaIbarra", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 10:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSanCristobal", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 11:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaDuran", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 12:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaLagoAgrio", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 13:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSantaRosa", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 14:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSucua", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 15:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSigSig", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 16:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaMejia", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 17:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaMorona", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 18:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaTena", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 19:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaCatamayo", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 20:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaLoja", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
                case 21:
                    url = "@Url.Action("ObtenerReportePrediosEmpresaSamborondon", "PrincipalDemo", new { Area = "Consultas" })";
                    break;
            }

            $.post({
                url: url,
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraPrediosEmpresa").css("display", "none");
                    $('#divPrediosEmpresaReintento').html(data);
                    $('#divPrediosEmpresaReintento').show();
                    $('#btnBuscarPrediosEmpresa').prop('disabled', false);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraPrediosEmpresa").css("display", "none");
                    $('#divPrediosEmpresaReintento').html(`<div class="alert alert-warning" role="alert">No fue posible procesar esta fuente.</div>`);
                    $('#divPrediosEmpresaReintento').show();
                    $('#btnBuscarPrediosEmpresa').prop('disabled', false);
                    Swal.fire("¡Error!", "No se pudo procesar la consulta para Predios.", "error");
                    console.log(error);
                }
            });
        }

        function obtenerFiscaliaDelitos(idHistorial, identificacion) {
            $("#divBarraFiscalia").show();
            $('#divFuenteFiscaliaDelitos').html("");

            $.post({
                url: "@Url.Action("ObtenerFiscaliaDelitos", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraFiscalia").css("display", "none");
                    $('#divFuenteFiscaliaDelitos').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraFiscalia").css("display", "none");
                    $("#divFuenteFiscaliaDelitos").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/fiscaliaDelitos.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Fiscalía Delitos
                                                                        <span class="badge badge-info pl-1"><a href="https://www.fiscalia.gob.ec/consulta-de-noticias-del-delito/" target="_blank" data-tippy-content="Página Oficial">Página Oficial</a></span>
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarFiscalia" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Noticias del Delito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerUafe(idHistorial, identificacion) {
            $("#divBarraUafe").show();
            $('#divFuenteUafe').html("");

            $.post({
                url: "@Url.Action("ObtenerUafe", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    $("#divBarraUafe").css("display", "none");
                    $('#divFuenteUafe').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraUafe").css("display", "none");
                    $("#divFuenteUafe").html(`<div class="row animate__animated animate__fadeInUp">
                                                        <div class="col">
                                                            <div class="card">
                                                                <div class="card-header">
                                                                    <div class="row">
                                                                        <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                            <img src="../images/iconos/uafe.svg" alt="" width="40" height="40">
                                                                            <span class="pl-2 my-auto">
                                                                                Información Unidad de Análisis Financiero y Económico
                                                                            </span>
                                                                        </div>
                                                                        <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                            <button type="submit" class="btn btn-primary-custom" id="btnBuscarUafe" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="card-body pt-2">
                                                                    <div class="row">
                                                                        <div class="col">
                                                                            <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Noticias del Delito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        ////////////////////////////////////////////////////////////////////////////
        //Configuración Calificación
        function obtenerCalificacion() {
            if (tipoIdentificacionTemp) tipoIdentificacionTempCalificacion = tipoIdentificacionTemp;

            if (!tipoIdentificacionTempCalificacion) {
                Swal.fire("¡Advertencia!", `No se encontró una identificación`, "warning");
                return;
            }

            $('#btnEvaluar').prop('disabled', true);
            $('#tab-evaluacion').show();
            $('[href="#tab-cont-evaluacion"]').tab('show');
            $("#divBarraCalificacion").show();
            $("#cardBodyCalificacion").css("display", "none");
            $('#divFuenteCalificacion').html("");
            let urlCalificacion;
            if (idEmpresa != 0 && idEmpresa === @Dominio.Constantes.Clientes.IdCliente0990304211001) {
                switch (tipoIdentificacionTempCalificacion) {
                    case "@Dominio.Constantes.General.Cedula":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_0990304211001", "Calificacion")";
                        break;
                    case "@Dominio.Constantes.General.RucNatural":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucNatural_0990304211001", "Calificacion")";
                        break;
                    case "@Dominio.Constantes.General.RucJuridico":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucJuridico_0990304211001", "Calificacion")";
                        break;
                    default:
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_0990304211001", "Calificacion")";
                        break;
                }
            }   else if (idEmpresa != 0 && idEmpresa === @Dominio.Constantes.Clientes.IdCliente1091796789001) {
                switch (tipoIdentificacionTempCalificacion) {
                    case "@Dominio.Constantes.General.Cedula":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_1091796789001", "CalificacionCliente")";
                        break;
                    case "@Dominio.Constantes.General.RucNatural":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucNatural_1091796789001", "CalificacionCliente")";
                        break;
                    case "@Dominio.Constantes.General.RucJuridico":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucJuridico_1091796789001", "CalificacionCliente")";
                        break;
                    default:
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_1091796789001", "CalificacionCliente")";
                        break;
                }
            } else if (idEmpresa != 0 && idEmpresa === @Dominio.Constantes.Clientes.IdCliente1090105244001) {
                switch (tipoIdentificacionTempCalificacion) {
                    case "@Dominio.Constantes.General.Cedula":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_1090105244001", "CalificacionCliente")";
                        break;
                    case "@Dominio.Constantes.General.RucNatural":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucNatural_1090105244001", "CalificacionCliente")";
                        break;
                    case "@Dominio.Constantes.General.RucJuridico":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucJuridico_1090105244001", "CalificacionCliente")";
                        break;
                    default:
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula_1090105244001", "CalificacionCliente")";
                        break;
                }
            } else {
                switch (tipoIdentificacionTempCalificacion) {
                    case "@Dominio.Constantes.General.Cedula":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula", "Calificacion")";
                        break;
                    case "@Dominio.Constantes.General.RucNatural":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucNatural", "Calificacion")";
                        break;
                    case "@Dominio.Constantes.General.RucJuridico":
                        urlCalificacion = "@Url.Action("ObtenerCalificacionRucJuridico", "Calificacion")";
                        break;
                    default:
                        urlCalificacion = "@Url.Action("ObtenerCalificacionCedula", "Calificacion")";
                        break;
                }
            }          

            $.post({
                url: urlCalificacion,
                data: {
                    "tipoIdentificacion": tipoIdentificacionTempCalificacion,
                    "idHistorial": idHistorialTemp,
                    "idCalificacion": idCalificacionTemp,
                    "idCalificacionBuro": idCalificacionBuroTemp
                },
                beforeSend: function () {
                    $("#divBarraCalificacion").show();
                    $("#cardBodyCalificacion").css("display", "none");
                    $('#divFuenteCalificacion').html("");
                },
                success: function (data) {
                    $("#divBarraCalificacion").css("display", "none");
                    $("#cardBodyCalificacion").show();
                    $('#divFuenteCalificacion').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });

                    ////////////////////////////////////////////////////////////////////////////
                    //Calificación Buró de Crédito
                    tabla = $('#tablaCalificacion').DataTable({
                        dom: "tip",
                        paging: false,
                        info: false,
                        language: {
                            url: dataTableLangPath
                        },
                        responsive: false,
                        columns: [
                            { width: "30%", },
                            { width: "30%" },
                            { width: "30%" },
                            { width: "10%" },
                        ],
                        order: []
                    });

                    ////////////////////////////////////////////////////////////////////////////
                    //Calificación General
                    tablaResumenCalificacion = $('#tablaCalificacionVarificada').DataTable({
                        dom: "l",
                        paging: false,
                        info: false,
                        language: {
                            url: dataTableLangPath
                        },
                        responsive: true,
                        order: [],
                        ordering: false,
                    });
                    tabla.init();
                    tabla.columns.adjust();
                    idCalificacionTemp = parseInt($('#idCalificacion').text());

                    ////////////////////////////////////////////////////////////////////////////
                    //Calificación Buró de Crédito
                    tablaBuro = $('#tablaCalificacionBuro').DataTable({
                        dom: "tip",
                        paging: false,
                        info: false,
                        language: {
                            url: dataTableLangPath
                        },
                        responsive: false,
                        columns: [
                            { width: "30%", },
                            { width: "30%" },
                            { width: "15%" },
                            { width: "10%" },
                            { width: "10%" },
                            { width: "5%" },

                        ],
                        order: []
                    });

                    ////////////////////////////////////////////////////////////////////////////
                    //Calificación Verificada Buró de Crédito
                    tablaResumenCalificacionBuro = $('#tablaCalificacionVarificadaBuro').DataTable({
                        dom: "l",
                        paging: false,
                        info: false,
                        language: {
                            url: dataTableLangPath
                        },
                        responsive: true,
                        order: [],
                        ordering: false,
                    });
                    tablaBuro.init();
                    tablaBuro.columns.adjust();
                    idCalificacionBuroTemp = parseInt($('#idCalificacionBuro').text());
                    // obtenerResumenConsultas();
                    if($("#valorDatoCalificacion").val() === "True")
                        $('.btnImprimirSolicitudCredito').prop('disabled', false);
                    else
                        $('.btnImprimirSolicitudCredito').prop('disabled', true);        
                    $('#btnEvaluar').prop('disabled', false);
                },
                error: function (error) {
                    $("#divBarraCalificacion").css("display", "none");
                    $("#tab-cont-evaluacion").html(`<div class="card">
                                                    <div class="card-header">
                                                        <div class="row">
                                                            <div class="col-lg-10 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                <img src="../images/iconos/listCheck.svg" alt="" width="40" height="40">
                                                                <span class="pl-2 my-auto">
                                                                    Evaluación Riesgo
                                                                </span>
                                                            </div>
                                                            <div class="col-lg-2 col-md-2  col-sm-4 col-3 text-right">
                                                                <button type="button" class="btn btnEvaluar btn-primary-custom d-inline-flex" id="btnEvaluar"><i class="fa-solid fa-list-check my-auto mr-1"></i><span class="d-none d-sm-none d-md-none d-lg-block">Evaluar</span></button>
                                                            </div>                                                           
                                                        </div>
                                                    </div>
                                                    <div class="card-body pt-2" id="cardBodyCalificacion">
                                                        <div id="divFuenteCalificacion">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Evaluar</b> para reintentar el procesamiento.</span></div>
                                                                    </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="progress" id="divBarraCalificacion" style="height:1rem; display: none">
                                                    <div class="progress-bar progress-bar-striped  bg-info progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">Procesando...</div>
                                                </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la Evaluación de Riesgo.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        ////////////////////////////////////////////////////////////////////////////
        //Configuración Buró Crédito
        function obtenerBuroCredito(idHistorial, identificacion) {
            $("#divBarraBuroCredito").show();
            $('#divFuenteBuroCredito').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBuroCredito", "PrincipalDemo", new { Area = "Consultas"})",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion
                },
                success: function (data) {
                    // obtenerResumenConsultas();
                    $("#divBarraBuroCredito").css("display", "none");
                    $('#divFuenteBuroCredito').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    $("#divBarraBuroCredito").css("display", "none");
                    $("#divFuenteBuroCredito").html(`<div class="row animate__animated animate__fadeInUp">
                                                <div class="col">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <div class="row">
                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                    <img src="../images/iconos/buroCredito.svg" alt="" width="40" height="40">
                                                                    <span class="pl-2 my-auto">
                                                                        Información Buró de Crédito
                                                                    </span>
                                                                </div>
                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarBuroCredito" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body pt-2">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Buró de Crédito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerBuroCreditoIndumot(idHistorial, identificacion, identificacionConyuge, identificacionGarante, tipoProducto, ingresos, gastos, monto, plazo, valorEntrada) {
            $("#divBarraBuroCredito").show();
            $('#divFuenteBuroCredito').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBuroCredito", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                    "identificacionConyugeIndumot": identificacionConyuge,
                    "identificacionGaranteIndumot": identificacionGarante,
                    "tipoProductoIndumot": tipoProducto,
                    "ingresosIndumot": ingresos,
                    "restaGastoFinancieroIndumot": gastos,
                    "montoIndumot": monto,
                    "plazoIndumot": plazo,
                    "valorEntradaIndumot": valorEntrada,
                },
                beforeSend: function () {
                    initLoadingSwal();
                },
                success: function (data) {
                    Swal.close();
                    $("#modalBuroIndumot").modal("hide");
                    $("#modalBuroIndumot").find("#formBuroIndumot")[0].reset();

                    // obtenerResumenConsultas();
                    $("#divBarraBuroCredito").css("display", "none");
                    $('#divFuenteBuroCredito').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.close();
                    $("#modalBuroIndumot").modal("hide");
                    $("#modalBuroIndumot").find("#formBuroIndumot")[0].reset();

                    $("#divBarraBuroCredito").css("display", "none");
                    $("#divFuenteBuroCredito").html(`<div class="row animate__animated animate__fadeInUp">
                                                                <div class="col">
                                                                    <div class="card">
                                                                        <div class="card-header">
                                                                            <div class="row">
                                                                                <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                                    <img src="../images/iconos/buroCredito.svg" alt="" width="40" height="40">
                                                                                    <span class="pl-2 my-auto">
                                                                                        Información Buró de Crédito
                                                                                    </span>
                                                                                </div>
                                                                                <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                                    <button type="submit" class="btn btn-primary-custom" id="btnBuscarBuroCredito" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-body pt-2">
                                                                            <div class="row">
                                                                                <div class="col">
                                                                                    <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Buró de Crédito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

          function obtenerBuroCreditoBancoCapital(idHistorial, identificacion, ingresos, gastos, montoSolicitado, plazo, tipoPrestamo, mesesExperienciaActividad, idConyuge, propiedades) {
            $("#divBarraBuroCredito").show();
            $('#divFuenteBuroCredito').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBuroCredito", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                    "ingresosBC": ingresos,
                    "gastosBC": gastos,
                    "montoSolicitadoBC": montoSolicitado,
                    "plazoBC": plazo,
                    "TipoPrestamoBC": tipoPrestamo,
                    "mesesExperienciaActividadBC" : mesesExperienciaActividad,
                    "identificacionConyugeBC" : idConyuge,
                    "propiedadesBC": propiedades

                },
                beforeSend: function() {
                    initLoadingSwal();
                },
                success: function (data) {
                    Swal.close();
                    $("#modalBuroBCapital").modal("hide");
                    $("#modalBuroBCapital").find("#formBuroBCapital")[0].reset();

                    // obtenerResumenConsultas();
                    $("#divBarraBuroCredito").css("display", "none");
                    $('#divFuenteBuroCredito').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.close();
                    $("#modalBuroBCapital").modal("hide");
                    $("#modalBuroBCapital").find("#formBuroBCapital")[0].reset();

                    $("#divBarraBuroCredito").css("display", "none");
                    $("#divFuenteBuroCredito").html(`<div class="row animate__animated animate__fadeInUp">
                                                        <div class="col">
                                                            <div class="card">
                                                                <div class="card-header">
                                                                    <div class="row">
                                                                        <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                            <img src="../images/iconos/buroCredito.svg" alt="" width="40" height="40">
                                                                            <span class="pl-2 my-auto">
                                                                                Información Buró de Crédito
                                                                            </span>
                                                                        </div>
                                                                        <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                            <button type="submit" class="btn btn-primary-custom" id="btnBuscarBuroCredito" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="card-body pt-2">
                                                                    <div class="row">
                                                                        <div class="col">
                                                                            <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Buró de Crédito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }

        function obtenerBuroCreditoCooperativas(idHistorial, identificacion, ingresos, gastos, montoSolicitado, plazo, tipoPrestamo) {
            $("#divBarraBuroCredito").show();
            $('#divFuenteBuroCredito').html("");
            $.post({
                url: "@Url.Action("ObtenerReporteBuroCredito", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                    "ingresos": ingresos,
                    "gastos": gastos,
                    "montoSolicitado": montoSolicitado,
                    "plazo": plazo,
                    "tipoPrestamo": tipoPrestamo
                },
                beforeSend: function () {
                    initLoadingSwal();
                },
                success: function (data) {
                    Swal.close();
                    $("#modalBuroCooperativas").modal("hide");
                    $("#modalBuroCooperativas").find("#formBuroCooperativas")[0].reset();

                    // obtenerResumenConsultas();
                    $("#divBarraBuroCredito").css("display", "none");
                    $('#divFuenteBuroCredito').html(data);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.close();
                    $("#modalBuroCooperativas").modal("hide");
                    $("#modalBuroCooperativas").find("#formBuroCooperativas")[0].reset();

                    $("#divBarraBuroCredito").css("display", "none");
                    $("#divFuenteBuroCredito").html(`<div class="row animate__animated animate__fadeInUp">
                                                                        <div class="col">
                                                                            <div class="card">
                                                                                <div class="card-header">
                                                                                    <div class="row">
                                                                                        <div class="col-lg-11 col-md-10 col-sm-8 col-9 d-inline-flex">
                                                                                            <img src="../images/iconos/buroCredito.svg" alt="" width="40" height="40">
                                                                                            <span class="pl-2 my-auto">
                                                                                                Información Buró de Crédito
                                                                                            </span>
                                                                                        </div>
                                                                                        <div class="col-lg-1 col-md-2 col-sm-4 col-3">
                                                                                            <button type="submit" class="btn btn-primary-custom" id="btnBuscarBuroCredito" data-tippy-content="Volver a Buscar"><i class="fa-solid fa-arrow-rotate-right fa-lg"></i></button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="card-body pt-2">
                                                                                    <div class="row">
                                                                                        <div class="col">
                                                                                            <div class="alert alert-warning" role="alert">No fue posible procesar esta fuente. Presione el botón <b>Volver a Buscar</b> para reintentar el procesamiento de la fuente de información.</span></div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>`);

                    Toast.fire({
                        icon: 'error',
                        title: "¡Error!",
                        text: "No se pudo procesar la consulta para Buró de Crédito.",
                        timer: 5000,
                    });
                    console.log(error);
                }
            });
        }


        ////////////////////////////////////////////////////////////////////////////
        //Funciones Varias
        function limpiar() {
            $("#IdHistorial").val("");
            $('#divInformacionGeneral').css("display", "none");
            $("#selectFuentePredios").val($("#selectFuentePredios option:first").val());
            tipoFuentePredios = "";
            identificacionTemp = "";
            tipoIdentificacionTemp = "";
            idHistorialTemp = 0;
            rucNuevo = "";
            estadoPlanEvaluacion = false;
            estadoPlanBuroCredito = false;
            fechaCedulacionIngreso = false;
            modeloIndumot = false;
            modeloBCapital = false;
            modeloCooperativas = false;
            $('.btnImprimirSolicitudCredito').prop('disabled', true);
        }

        function obtenerResumenConsultas() {
            $("#divResumenConsultas").html("");
            $.post({
                url: "@Url.Action("ObtenerResumenConsultas", "Principal", new { Area = "Consultas"})",
                beforeSend: function () {
                    $("#divResumenConsultas").html(`<div class="d-flex justify-content-center">
                                                <div class="spinner-border" role="status">
                                                    <span class="sr-only">Cargando...</span>
                                                </div>
                                            </div>`);
                },
                success: function (data) {
                    let detalleConsultas = parseInt("@detalleConsultas");
                    if (!data || data === null) {
                        $("#divResumenConsultas").html(`<div class="d-flex justify-content-center">
                                                                                <div class="alert alert-info note note-${classAlert} text-justify" role="alert">
                                                                                        <div class="row">
                                                                                            <div class="col">
                                                                                                        <span class="pr-1"><i class="fa-solid fa-circle-info mr-1 font-weight-bold text-info"></i>&nbsp;</span> No se han registrado consultas...
                                                                                            </div>
                                                                                        </div>
                                                                                </div>`);
                        return false;
                    }

                    $("#divResumenConsultas").html("");
                    let classAlert = "primary";
                    let html = `<div class="alert alert-info note note-${classAlert} text-justify" role="alert">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <span class="pr-1"><i class="fa-solid fa-circle-info mr-1 font-weight-bold text-${classAlert}"></i>&nbsp;</span> <b style="font-size:0.975rem">RESUMEN DE CONSULTAS:</b>
                                                                    <b>Última consulta realizada: </b> ${data.ultimaConsulta ?? "N/A"}<br/>
                                                                </div>
                                                                <div class="col text-right">
                                                                            <button class="btn btn-sm btn-primary-custom" onclick="obtenerResumenConsultas()" data-tippy-content="Actualizar"><i class="fa-solid fa-arrow-rotate-right text-white"></i></button>
                                                                </div>
                                                            </div>
                                                            <hr class="mt-1 mb-1"/>
                                                            <b>Empresa: </b>${data.empresa.ruc} - ${data.empresa.razonSocial}<br/>`;

                    if (data.planes)
                        if (data.planes.length > 0) {
                            html += `<b>Planes Activos: </b><br/>`;
                            $.each(data.planes, function (index, item) {
                                if (detalleConsultas === 1) {
                                    let htmlPopover = "";
                                    htmlPopover += `<b>Nombre Plan: </b>  ${item.nombrePlan} <br/>`;
                                    htmlPopover += `<b>Tipo Plan: </b>  ${(!item.esUnificado ? 'Dividido por Cédulas y RUCs' : 'Unificado (Cédulas y RUCs)')} <br/>`;
                                    if (!item.esUnificado) {
                                        htmlPopover += `<b>Num. Consultas RUCs: </b>  ${(!item.maximoConsultasRucs ? item.numeroConsultasRuc : "MAX")} <br/>`;
                                        htmlPopover += `<b>Num. Consultas Cédulas: </b>  ${(!item.maximoConsultasCedulas ? item.numeroConsultasCedula : "MAX")} <br/>`;
                                    } else {
                                        htmlPopover += `<b>Num. Consultas: </b>  ${(!item.maximoConsultas ? item.numeroConsultas : "MAX")} <br/>`;
                                    }

                                    htmlPopover += `<b>Fecha Inicio: </b>  ${item.fechaInicioPlan} <br/>`;
                                    htmlPopover += `<b>Fecha Fin: </b>  ${item.fechaFinPlan} <br/>`;
                                    htmlPopover += `<b>Fecha de Cobro Mensual: </b>  ${item.fechaCobroRecurrente} <br/>`;
                                    if (!item.esUnificado) {
                                        htmlPopover += `<b>Valor por Consulta RUCs: </b> <span class='badge badge-success'>$ ${item.valorPorConsultaRucs}</span> <br/>`;
                                        htmlPopover += `<b>Valor por Consulta Cédulas: </b> <span class='badge badge-success'>$ ${item.valorPorConsultaCedulas}</span> <br/>`;
                                        htmlPopover += `<b>Valor Consulta Adicional RUCs: </b> <span class='badge badge-danger'>$ ${item.valorConsultaAdicionalRucs}</span> <br/>`;
                                        htmlPopover += `<b>Valor Consulta Adicional Cédulas: </b> <span class='badge badge-danger'>$ ${item.valorConsultaAdicionalCedulas}</span> <br/>`;
                                        htmlPopover += `<b>Valor Mensual RUCs: </b> <span class='badge badge-info'>$ ${item.valorMensualRuc}</span> <br/>`;
                                        htmlPopover += `<b>Valor Mensual Cédulas: </b> <span class='badge badge-info'>$ ${item.valorMensualCedula}</span> <br/>`;
                                        htmlPopover += `<b>Valor Anual RUCs: </b> <span class='badge badge-primary'>$ ${item.valorAnualRuc}</span> <br/>`;
                                        htmlPopover += `<b>Valor Anual Cédulas: </b> <span class='badge badge-primary'>$ ${item.valorAnualCedula}</span> <br/>`;
                                    } else {
                                        htmlPopover += `<b>Valor por Consulta: </b> <span class='badge badge-success'>$ ${item.valorPorConsulta}</span> <br/>`;
                                        htmlPopover += `<b>Valor Consulta Adicional: </b> <span class='badge badge-danger'>$ ${item.valorConsultaAdicional}</span> <br/>`;
                                        htmlPopover += `<b>Valor Mensual: </b> <span class='badge badge-info'>$ ${item.valorPlanMensual}</span> <br/>`;
                                        htmlPopover += `<b>Valor Anual: </b> <span class='badge badge-primary'>$ ${item.valorPlanAnual}</span> <br/>`;
                                    }

                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> ${item.nombrePlan} <a href="#" data-toggle="popover" title="Detalle de Plan" tabindex="0" data-mdb-toggle="popover" data-mdb-trigger="focus" data-mdb-content="${htmlPopover}"><i class="fa-solid fa-message text-primary"></i></a><br/>`
                                } else
                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> ${item.nombrePlan} <br/>`
                            });
                        }

                    if (data.planesBuroCredito)
                        if (data.planesBuroCredito.length > 0) {
                            $.each(data.planesBuroCredito, function (index, item) {
                                if (detalleConsultas === 1) {
                                    let htmlPopoverBuro = "";
                                    htmlPopoverBuro += `<b>Fuente: </b>  ${(item.fuente)} <br/>`;
                                    htmlPopoverBuro += `<b>Num. Consultas: </b>  ${(!item.maximoNumeroConsultas ? item.numeroMaximoConsultas : "MAX")} <br/>`;
                                    htmlPopoverBuro += `<b>Días de consulta caché: </b>  ${item.persistenciaCache} <br/>`;
                                    htmlPopoverBuro += `<b>Fecha Inicio: </b>  ${item.fechaInicioPlan} <br/>`;
                                    htmlPopoverBuro += `<b>Fecha Fin: </b>  ${item.fechaFinPlan} <br/>`;
                                    htmlPopoverBuro += `<b>Fecha de Cobro Mensual: </b>  ${item.fechaCobroRecurrente} <br/>`;
                                    htmlPopoverBuro += `<b>Valor por Consulta: </b> <span class='badge badge-success'>$ ${item.valorConsulta}</span> <br/>`;
                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> @(Dominio.Constantes.PlanesBuroCredito.PlanBuroCreditoMensaje) <a href="#" data-toggle="popover" title="Detalle de Plan" tabindex="0" data-mdb-toggle="popover" data-mdb-trigger="focus" data-mdb-content="${htmlPopoverBuro}"><i class="fa-solid fa-message text-primary"></i></a><br/>`
                                } else
                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> @(Dominio.Constantes.PlanesBuroCredito.PlanBuroCreditoMensaje) <br/>`
                            });
                        }

                    if (data.planesEvaluaciones)
                        if (data.planesEvaluaciones.length > 0) {
                            $.each(data.planesEvaluaciones, function (index, item) {
                                if (detalleConsultas === 1) {
                                    let htmlPopoverEvaluaciones = "";
                                    htmlPopoverEvaluaciones += `<b>Num. Consultas: </b>  ${(!item.maximoNumeroConsultas ? item.numeroMaximoConsultas : "MAX")} <br/>`;
                                    htmlPopoverEvaluaciones += `<b>Fecha Inicio: </b>  ${item.fechaInicioPlan} <br/>`;
                                    htmlPopoverEvaluaciones += `<b>Fecha Fin: </b>  ${item.fechaFinPlan} <br/>`;
                                    htmlPopoverEvaluaciones += `<b>Fecha de Cobro Mensual: </b>  ${item.fechaCobroRecurrente} <br/>`;
                                    htmlPopoverEvaluaciones += `<b>Valor por Consulta: </b> <span class='badge badge-success'>$ ${item.valorConsulta}</span> <br/>`;
                                    htmlPopoverEvaluaciones += `<b>Valor por Consulta Adicional: </b> <span class='badge badge-danger'>$ ${item.valorConsultaAdicional}</span> <br/>`;
                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> @(Dominio.Constantes.PlanesEvaluacion.PlanEvaluacionesMensaje) <a href="#" data-toggle="popover" title="Detalle de Plan" tabindex="0" data-mdb-toggle="popover" data-mdb-trigger="focus" data-mdb-content="${htmlPopoverEvaluaciones}"><i class="fa-solid fa-message text-primary"></i></a><br/>`
                                } else
                                    html += `<span><i class="fa-solid fa-circle-check text-success"></i></span> @(Dominio.Constantes.PlanesEvaluacion.PlanEvaluacionesMensaje) <br/>`
                            });
                        }

                    if (data.consultasRealizadasEmpresa)
                        if (data.consultasRealizadasEmpresa.length > 0)
                            html += `<hr class="mt-1 mb-1"/>`;

                    html += "<div class='row'>";
                    if (data.consultasRealizadasEmpresa)
                        if (data.consultasRealizadasEmpresa.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas (General): </b><br/>`;
                            $.each(data.consultasRealizadasEmpresa, function (index, item) {
                                let badgePlanEmpresaRuc = "success";
                                let badgePlanEmpresaCedula = "success";
                                let iconPlanEmpresaRuc = "<i class='fa-solid fa-shield text-success'></i>";
                                let iconPlanEmpresaCedula = "<i class='fa-solid fa-shield text-success'></i>";
                                let textoPlanEmpresaRuc = "Dentro del límite de consultas RUCs";
                                let textoPlanEmpresaCedula = "Dentro del límite de consultas Cédulas";
                                let planEmpresa = data.planes.find(x => parseInt(x.idPlanEmpresa) === parseInt(item.idPlanEmpresa));
                                if (planEmpresa) {
                                    if (!planEmpresa.esUnificado) {
                                        if (item.numeroConsultasRucs > planEmpresa.numeroConsultasRuc) {
                                            badgePlanEmpresaRuc = "danger";
                                            iconPlanEmpresaRuc = "<i class='fa-solid fa-triangle-exclamation text-danger'></i>";
                                            textoPlanEmpresaRuc = "Límite de consultas excedido RUCs";
                                        }
                                        if (item.numeroConsultasRucs === planEmpresa.numeroConsultasRuc) {
                                            badgePlanEmpresaRuc = "warning";
                                            iconPlanEmpresaRuc = "<i class='fas fa-exclamation-circle text-warning'></i>";
                                            textoPlanEmpresaRuc = "Límite de consultas alcanzado RUCs";
                                        }
                                        if (item.numeroConsultasCedula > planEmpresa.numeroConsultasCedula) {
                                            badgePlanEmpresaCedula = "danger";
                                            iconPlanEmpresaCedula = "<i class='fa-solid fa-triangle-exclamation text-danger'></i>";
                                            textoPlanEmpresaCedula = "Límite de consultas excedido Cédulas";
                                        }
                                        if (item.numeroConsultasCedula === planEmpresa.numeroConsultasCedula) {
                                            badgePlanEmpresaCedula = "warning";
                                            iconPlanEmpresaCedula = "<i class='fas fa-exclamation-circle text-warning'></i>";
                                            textoPlanEmpresaCedula = "Límite de consultas alcanzado Cédulas";
                                        }
                                        html += `RUCS (Jurídicos y Naturales): <b class="text-${badgePlanEmpresaRuc}">${item.numeroConsultasRucs} consultas</b> <span data-tippy-content="${textoPlanEmpresaRuc}" class="text-${badgePlanEmpresaRuc}">${iconPlanEmpresaRuc}</span><br/>`
                                        html += `Cédulas: <b class="text-${badgePlanEmpresaCedula}">${item.numeroConsultasCedula} consultas</b> <span data-tippy-content="${textoPlanEmpresaCedula}" class="text-${badgePlanEmpresaCedula}">${iconPlanEmpresaCedula}</span><br/>`
                                    } else {
                                        if (item.numeroConsultas > planEmpresa.numeroConsultas) {
                                            badgePlanEmpresaRuc = "danger";
                                            iconPlanEmpresaRuc = "<i class='fa-solid fa-triangle-exclamation text-danger'></i>";
                                            textoPlanEmpresaRuc = "Límite de consultas excedido";
                                        }
                                        if (item.numeroConsultas === planEmpresa.numeroConsultas) {
                                            badgePlanEmpresaRuc = "warning";
                                            iconPlanEmpresaRuc = "<i class='fas fa-exclamation-circle text-warning'></i>";
                                            textoPlanEmpresaRuc = "Límite de consultas alcanzado";
                                        }
                                        html += `Cédulas y RUCs: <b class="text-${badgePlanEmpresaRuc}">${(item.numeroConsultas ? item.numeroConsultas : 0)} consultas</b> <span data-tippy-content="${textoPlanEmpresaRuc}" class="text-${badgePlanEmpresaRuc}">${iconPlanEmpresaRuc}</span><br/>`
                                    }
                                }
                            });
                            html += "</div>";
                        }

                    if (data.consultasRealizadasUsuario)
                        if (data.consultasRealizadasUsuario.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas (Usuario Actual): </b><br/>`;
                            $.each(data.consultasRealizadasUsuario, function (index, item) {
                                let planEmpresa = data.planes.find(x => parseInt(x.idPlanEmpresa) === parseInt(item.idPlanEmpresa));
                                if (planEmpresa) {
                                    if (!planEmpresa.esUnificado) {
                                        html += `RUCS (Jurídicos y Naturales): <b>${item.numeroConsultasRucs}</b> consultas. <br/>`
                                        html += `Cédulas: <b>${item.numeroConsultasCedula}</b> consultas. <br/>`
                                    } else {
                                        html += `Cédulas y RUCs: <b>${(item.numeroConsultas ? item.numeroConsultas : 0)}</b> consultas. <br/>`
                                    }
                                }
                            });
                            html += "</div>";
                        }
                    html += "</div>";

                    if (data.consultasRealizadasBuroEmpresa)
                        if (data.consultasRealizadasBuroEmpresa.length > 0)
                            html += `<hr class="mt-1 mb-1"/>`;

                    html += "<div class='row'>";
                    if (data.consultasRealizadasBuroEmpresa)
                        if (data.consultasRealizadasBuroEmpresa.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas Buró de Crédito (General): </b><br/>`;
                            $.each(data.consultasRealizadasBuroEmpresa, function (index, item) {
                                let badgePlanBuroEmpresa = "success";
                                let iconPlanBuroEmpresa = "<i class='fa-solid fa-shield text-success'></i>";
                                let textoPlanBuroEmpresa = "Dentro del límite de consultas de Buró de Crédito";
                                let planBuroEmpresa = data.planesBuroCredito.find(x => parseInt(x.idPlanBuroCredito) === parseInt(item.idPlanBuroCredito));
                                if (planBuroEmpresa) {
                                    if (item.numeroConsultas > planBuroEmpresa.numeroMaximoConsultas) {
                                        badgePlanBuroEmpresa = "danger";
                                        iconPlanBuroEmpresa = "<i class='fa-solid fa-triangle-exclamation text-danger'></i>";
                                        textoPlanBuroEmpresa = "Límite de consultas excedido en el Buró de Crédito";
                                    }
                                    if (item.numeroConsultas == planBuroEmpresa.numeroMaximoConsultas) {
                                        badgePlanBuroEmpresa = "warning";
                                        iconPlanBuroEmpresa = "<i class='fas fa-exclamation-circle text-warning'></i>";
                                        textoPlanBuroEmpresa = "Límite de consultas alcanzado en el Buró de Crédito";
                                    }
                                    html += `RUCS y Cédulas: <b class="text-${badgePlanBuroEmpresa}">${item.numeroConsultas} consultas</b> <span data-tippy-content="${textoPlanBuroEmpresa}" class="text-${badgePlanBuroEmpresa}">${iconPlanBuroEmpresa}</span><br/>`
                                }
                            });
                            html += "</div>";
                        }

                    if (data.consultasRealizadasBuroUsuario)
                        if (data.consultasRealizadasBuroUsuario.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas Buró de Crédito (Usuario Actual): </b><br/>`;
                            $.each(data.consultasRealizadasBuroUsuario, function (index, item) {
                                let planBuro = data.planesBuroCredito.find(x => parseInt(x.idPlanBuroCredito) === parseInt(item.idPlanBuroCredito));
                                if (planBuro) {
                                    html += `RUCS y Cédulas: <b>${item.numeroConsultas}</b> consultas. <br/>`
                                }
                            });
                            html += "</div>";
                        }
                    html += "</div>";

                    //RESUMEN CONSULTAS EVALUCIONES
                    if (data.consultasRealizadasEvaluacionesEmpresa)
                        if (data.consultasRealizadasEvaluacionesEmpresa.length > 0)
                            html += `<hr class="mt-1 mb-1"/>`;

                    html += "<div class='row'>";
                    if (data.consultasRealizadasEvaluacionesEmpresa)
                        if (data.consultasRealizadasEvaluacionesEmpresa.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas Evaluaciones (General): </b><br/>`;
                            $.each(data.consultasRealizadasEvaluacionesEmpresa, function (index, item) {
                                let badgePlanEvaluacionesEmpresa = "success";
                                let iconPlanEvaluacionesEmpresa = "<i class='fa-solid fa-shield text-success'></i>";
                                let textoPlanEvaluacionesEmpresa = "Dentro del límite de consultas de Evaluaciones";
                                let planEvaluacionesEmpresa = data.planesEvaluaciones.find(x => parseInt(x.idPlanEvaluaciones) === parseInt(item.idPlanEvaluaciones));
                                if (planEvaluacionesEmpresa) {
                                    if (item.numeroConsultas > planEvaluacionesEmpresa.numeroMaximoConsultas) {
                                        badgePlanEvaluacionesEmpresa = "danger";
                                        iconPlanEvaluacionesEmpresa = "<i class='fa-solid fa-triangle-exclamation text-danger'></i>";
                                        textoPlanEvaluacionesEmpresa = "Límite de consultas excedido en Evaluaciones";
                                    }
                                    if (item.numeroConsultas === planEvaluacionesEmpresa.numeroMaximoConsultas) {
                                        badgePlanEvaluacionesEmpresa = "warning";
                                        iconPlanEvaluacionesEmpresa = "<i class='fas fa-exclamation-circle text-warning'></i>";
                                        textoPlanEvaluacionesEmpresa = "Límite de consultas alcanzado en Evaluaciones";
                                    }
                                    html += `RUCS y Cédulas: <b class="text-${badgePlanEvaluacionesEmpresa}">${item.numeroConsultas} consultas</b> <span data-tippy-content="${textoPlanEvaluacionesEmpresa}" class="text-${badgePlanEvaluacionesEmpresa}">${iconPlanEvaluacionesEmpresa}</span><br/>`
                                }
                            });
                            html += "</div>";
                        }

                    if (data.consultasRealizadasEvaluacionesUsuario)
                        if (data.consultasRealizadasEvaluacionesUsuario.length > 0) {
                            html += "<div class='col'>";
                            html += `<b>Consultas Realizadas Evaluaciones (Usuario Actual): </b><br/>`;
                            $.each(data.consultasRealizadasEvaluacionesUsuario, function (index, item) {
                                let planEvaluaciones = data.planesEvaluaciones.find(x => parseInt(x.idPlanEvaluaciones) === parseInt(item.idPlanEvaluaciones));
                                if (planEvaluaciones) {
                                    html += `RUCS y Cédulas: <b>${item.numeroConsultas}</b> consultas. <br/>`
                                }
                            });
                            html += "</div>";
                        }
                    html += "</div>";
                    //FIN RESUMEN CONSULTAS EVALUCIONES

                    $("#divResumenConsultas").html(html);
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });

                    $(function () {
                        $('[data-toggle="popover"]').popover({
                            html: true
                        })
                    })
                },
                error: function (error) {
                    $("#divResumenConsultas").html("");
                    console.log(error);
                }
            });
        }

        function obtenerPermisoEvaluacion() {
            estadoPlanEvaluacion = false;
            $.ajax({
                url: '@Url.Action("PermisoEvaluacionUsuario", "Calificacion", new { Area = "Consultas"})',
                method: 'POST',
                cache: false,
                datatype: "json",
                success: function (data) {
                    switch (data.resultadoPermiso) {
                        case 1:
                            $("#divAccesos").html(`Para procesar la evaluacíón debe terminar de procesar todas las fuentes y presionar el botón <b>EVALUAR</b>. <br> Actualmente tiene realizadas <b>${data.numeroConsultasRealizadas}</b> evaluaciones.`);
                            $("#divAccesos").toggleClass('alert-warning alert-info');
                            estadoPlanEvaluacion = true;
                            break;
                        case 2:
                            $("#divAccesos").html(`El número de consultas del <b>PLAN</b> contratado ha sido superado. <br> Actualmente su empresa tiene un plan de evaluación con <b>${data.numeroConsultasContratadas}</b> evaluaciones.`);
                            $("#divAccesos").toggleClass('alert-warning alert-warning');
                            break;
                        case 3:
                            $("#divAccesos").html("El usuario con el que está logueado no cuenta con los permisos para realizar la <b>EVALUACIÓN</b>.");
                            $("#divAccesos").toggleClass('alert-warning alert-warning');
                            break;
                    }
                    Swal.close();
                },
                error: function (error) {
                    Swal.fire("¡Error!", error && error.responseJSON ? error.responseJSON.detail : (error && error.responseText ? `No se pudo procesar la consulta para plan de evaluación.. ${error.responseText}` : `No se pudo procesar la consulta para plan de evaluación.. `), "error");
                    console.log(error);
                }
            });
        }

        function obtenerPermisoBuroCredito() {
            estadoPlanBuroCredito = false;
            modeloIndumot = false;
            modeloBCapital = false;
            modeloCooperativas = false;
            $.ajax({
                url: '@Url.Action("PermisoBuroCredito", "Principal", new { Area = "Consultas"})',
                method: 'POST',
                cache: false,
                datatype: "json",
                success: function (data) {
                    modeloIndumot = data.modeloIndumot;
                    modeloBCapital = data.modeloBCapital;
                    modeloCooperativas = data.modeloCooperativas;
                    switch (data.resultadoPermiso) {
                        case @((short)Dominio.Tipos.EstadosPlanesBuroCredito.Activo):
                            $("#divHabilitarBuro").html(`Para realizar la consulta en el Buró de Crédito presionar el botón <b>CONSULTAR BURÓ CRÉDITO</b>. <br> Actualmente tiene realizadas <b>${data.numeroConsultasRealizadas}</b> consultas.`);
                            $("#divHabilitarBuro").addClass('alert-info');
                            $("#btnBuscarBuroCreditoNuevo").removeClass('d-none');
                            estadoPlanBuroCredito = true;
                            break;
                        case @((short)Dominio.Tipos.EstadosPlanesBuroCredito.Inactivo):
                            if (data.numeroConsultasContratadas == 0) {
                                $("#divHabilitarBuro").addClass('alert-warning');
                                $("#divHabilitarBuro").html(`Actualmente su empresa tiene un <b>PLAN BURÓ DE CRÉDITO</b> con: <b>${data.numeroConsultasContratadas}</b> consulta(s).`);
                            } else {
                                $("#divHabilitarBuro").removeClass('alert-info');
                                $("#divHabilitarBuro").addClass('alert-warning');
                                $("#divHabilitarBuro").html(`El número de consultas del <b>PLAN BURÓ DE CRÉDITO</b> contratado ha sido alcanzado. <br> Actualmente su empresa tiene un plan con: <b>${data.numeroConsultasContratadas}</b> consulta(s).`);
                            }
                            $("#btnBuscarBuroCreditoNuevo").removeClass('d-none');
                            break;
                        case @((short)Dominio.Tipos.EstadosPlanesBuroCredito.Bloqueado):
                            $("#divHabilitarBuro").html("El usuario actual no cuenta con los permisos necesarios para realizar la consulta al <b>BURÓ DE CRÉDITO</b>.");
                            $("#divHabilitarBuro").addClass('alert-warning');
                            $("#btnBuscarBuroCreditoNuevo").removeClass('d-none');
                            break;
                    }
                    Swal.close();
                },
                error: function (error) {
                    Swal.fire("¡Error!", error && error.responseJSON ? error.responseJSON.detail : (error && error.responseText ? `No se pudo procesar la consulta para plan de <b>BURÓ DE CRÉDITO</b>.. ${error.responseText}` : `No se pudo procesar la consulta para plan de <b>BURÓ DE CRÉDITO</b>.. `), "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelTotalDeudaHistorica(idHistorial, identificacion) {
            $.post({
                url: "@Url.Action("ObtenerNivelTotalDeudaHistoricaEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelTotalDeudaHistorica .modal-body').html(data);
                    $('#modalNivelTotalDeudaHistorica').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Total Deuda Historica.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelEvolucionHistorica(idHistorial, identificacion) {
            $.post({
                url: "@Url.Action("ObtenerNivelEvolucionHistoricaDistribucionEndeudamientoEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelEvolucionHistorica .modal-body').html(data);
                    $('#modalNivelEvolucionHistorica').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Evolución Histórica Distribución Endeudamiento.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelHistoricoEstructuraVencimientos(idHistorial, identificacion) {
            $.post({
                url: "@Url.Action("ObtenerNivelHistoricoEstructuraVencimientosEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorial,
                    "identificacion": identificacion,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelHistoricoEstructuraVencimientos .modal-body').html(data);
                    $('#modalNivelHistoricoEstructuraVencimientos').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Histórico Estructura Vencimientos.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelSaldoVencerInstitucion(codigoInstitucion) {
            $.post({
                url: "@Url.Action("ObtenerNivelSaldoPorVencerPorInstitucionEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorialTemp,
                    "identificacion": identificacionTemp,
                    "codigoInstitucion": codigoInstitucion,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelSaldoVencerInstitucion .modal-body').html(data);
                    $('#modalNivelSaldoVencerInstitucion').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Saldo Por Vencer Por Institución.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelOperacionesInstitucion(codigoInstitucion, tipoCredito, fechaCorte) {
            $.post({
                url: "@Url.Action("ObtenerNivelOperacionesInstitucionEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorialTemp,
                    "identificacion": identificacionTemp,
                    "codigoInstitucion": codigoInstitucion,
                    "tipoCredito": tipoCredito,
                    "fechaCorte": fechaCorte
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelOperacionesInstitucion .modal-body').html(data);
                    $('#modalNivelOperacionesInstitucion').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Operaciones por Instituciones.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelDetalleVencidoInstitucion(codigoInstitucion) {
            $.post({
                url: "@Url.Action("ObtenerNivelDetalleVencidoPorInstitucionEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorialTemp,
                    "identificacion": identificacionTemp,
                    "codigoInstitucion": codigoInstitucion,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelDetalleVencidoInstitucion .modal-body').html(data);
                    $('#modalNivelDetalleVencidoInstitucion').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Detalle Vencido Por Institución.', "error");
                    console.log(error);
                }
            });
        }

        function obtenerNivelDetalleOperacionEntidad(fechaCorte, sistemaCrediticio) {
            $.post({
                url: "@Url.Action("ObtenerNivelDetalleOperacionesEntidadesEquifax", "PrincipalDemo", new { Area = "Consultas" })",
                data: {
                    "idHistorial": idHistorialTemp,
                    "identificacion": identificacionTemp,
                    "fechaCorte": fechaCorte,
                    "sistemaCrediticio": sistemaCrediticio,
                },
                beforeSend: function () {
                    initLoadingSwal("Cargando...");
                },
                success: function (data) {
                    swal.close();
                    $('#modalNivelDetalleOperacionEntidad .modal-body').html(data);
                    $('#modalNivelDetalleOperacionEntidad').modal('show');
                    tippy('[data-tippy-content]', { placement: 'bottom', arrow: false });
                },
                error: function (error) {
                    Swal.fire("¡Error!", 'No se pudo procesar la información de Nivel Detalle Operaciones y Entidades.', "error");
                    console.log(error);
                }
            });
        }

    </script>
}